import{c as C,r as h,o as B,a as N,b as n,d as a,e,f as w,g as f,t as r,u as l,n as E,w as T,F as V,h as q,T as H,i as z,j as D,k as O,l as _,m as R,H as F,p as K,q as M,s as k,v as L,x as W,y as G}from"./index-Hs7aDjjl-1765281840129.js";import{u as J,a as Q}from"./useLocale-BGSA8Lij-1765281840129.js";import{L as X}from"./lock-ByEb_iqQ-1765281840129.js";import{C as Y}from"./circle-alert-BgqgMps3-1765281840129.js";import{K as Z}from"./key-D2n3iSJi-1765281840129.js";/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=C("at-sign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=C("log-in",[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=C("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=C("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),oe=["aria-expanded"],le={class:"text-lg"},ne={key:0,class:"text-sm text-gray-200"},re={key:0,class:"absolute right-0 mt-2 w-40 rounded-xl bg-gray-800 border border-gray-700 shadow-lg z-50 overflow-hidden",role:"listbox"},ie=["onClick","aria-selected"],ue={class:"text-lg"},ce={class:"text-sm text-gray-200"},de={key:0,class:"w-4 h-4 text-purple-400 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},pe={__name:"LanguageSwitcher",props:{showLabel:{type:Boolean,default:!0},buttonClass:{type:String,default:""}},setup($){const{locale:g,currentLocale:u,locales:m,changeLocale:U}=J(),c=h(!1),y=h(null);function s(d){U(d),c.value=!1}function b(d){y.value&&!y.value.contains(d.target)&&(c.value=!1)}return B(()=>{document.addEventListener("click",b)}),N(()=>{document.removeEventListener("click",b)}),(d,i)=>(a(),n("div",{class:"relative",ref_key:"dropdownRef",ref:y},[e("button",{onClick:i[0]||(i[0]=t=>c.value=!c.value),class:E(["flex items-center gap-2 px-3 py-2 rounded-lg bg-gray-800/50 hover:bg-gray-700/50 transition-all border border-gray-700/50",$.buttonClass]),type:"button","aria-expanded":c.value,"aria-haspopup":"listbox"},[e("span",le,r(l(u).flag),1),$.showLabel?(a(),n("span",ne,r(l(u).name),1)):f("",!0),(a(),n("svg",{class:E(["w-4 h-4 text-gray-400 transition-transform",{"rotate-180":c.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...i[1]||(i[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))],10,oe),w(H,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:T(()=>[c.value?(a(),n("div",re,[(a(!0),n(V,null,q(l(m),t=>(a(),n("button",{key:t.code,onClick:v=>s(t.code),class:E(["w-full flex items-center gap-3 px-4 py-3 hover:bg-gray-700/50 transition-colors text-left",{"bg-purple-600/20":t.code===l(g)}]),role:"option","aria-selected":t.code===l(g)},[e("span",ue,r(t.flag),1),e("span",ce,r(t.name),1),t.code===l(g)?(a(),n("svg",de,[...i[2]||(i[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):f("",!0)],10,ie))),128))])):f("",!0)]),_:1})],512))}},me={class:"min-h-screen flex flex-col items-center justify-center px-4 py-8 relative"},ve={class:"absolute top-4 right-4"},he={class:"card max-w-md w-full shrink-0"},ge={class:"text-center mb-8"},fe={class:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-purple-600 to-pink-600 mb-4"},ye={class:"text-4xl font-bold gradient-text mb-2"},ke={class:"text-gray-400"},we={class:"block text-sm font-medium mb-2 text-gray-300"},be=["type","placeholder"],xe={class:"block text-sm font-medium mb-2 text-gray-300"},_e={key:0,class:"flex items-center gap-2 p-4 rounded-xl bg-red-500/10 border border-red-500/30 text-red-400"},Le=["disabled"],Ce={key:0,class:"loading-spinner"},$e={key:1,class:"relative"},Ue={class:"relative flex justify-center text-sm"},Se={class:"px-2 bg-gray-800 text-gray-400"},Ee=["disabled"],je={key:0,class:"loading-spinner"},Ne={__name:"Login",setup($){const g=R(),{t:u}=z(),m=D(),U=O(),{checkSupport:c,loginWithConditionalUI:y}=Q(),s=_(()=>m.authConfig),b=_(()=>U.appName),d=h(""),i=h(""),t=h(!1),v=h(""),x=h(!1),P=_(()=>s.value.allowEmailLogin&&!s.value.allowUsernameLogin?u("auth.email"):!s.value.allowEmailLogin&&s.value.allowUsernameLogin?u("auth.username"):u("auth.emailOrUsername")),A=_(()=>s.value.allowEmailLogin&&!s.value.allowUsernameLogin?"john@example.com":!s.value.allowEmailLogin&&s.value.allowUsernameLogin?"john_doe":u("auth.identifierPlaceholder"));B(async()=>{await m.fetchAuthConfig();const o=await c();x.value=o.supported;const p=localStorage.getItem("hasUsedPasskey");x.value&&p==="true"&&setTimeout(()=>{console.log("[Login] Auto-triggering passkey login for returning user"),j()},500)});async function I(){t.value=!0,v.value="";try{await m.login(d.value,i.value),g.push("/")}catch(o){v.value=o.response?.data?.error||u("auth.loginError")}finally{t.value=!1}}async function j(){t.value=!0,v.value="";try{const o=await y(null,!1);localStorage.setItem("hasUsedPasskey","true"),m.setTokens(o.access,o.refresh),await m.loadUser(),g.push("/")}catch(o){v.value=o.message||u("auth.loginError")}finally{t.value=!1}}return(o,p)=>(a(),n("div",me,[e("div",ve,[w(pe,{showLabel:!1})]),e("div",he,[e("div",ge,[e("div",fe,[w(l(F),{class:"w-8 h-8 text-white"})]),e("h1",ye,r(b.value),1),e("p",ke,r(o.$t("dashboard.overview")),1)]),e("form",{onSubmit:K(I,["prevent"]),class:"space-y-5"},[e("div",null,[e("label",we,[s.value.allowEmailLogin&&!s.value.allowUsernameLogin?(a(),k(l(ae),{key:0,class:"w-4 h-4 inline mr-2"})):!s.value.allowEmailLogin&&s.value.allowUsernameLogin?(a(),k(l(se),{key:1,class:"w-4 h-4 inline mr-2"})):(a(),k(l(ee),{key:2,class:"w-4 h-4 inline mr-2"})),L(" "+r(P.value),1)]),M(e("input",{"onUpdate:modelValue":p[0]||(p[0]=S=>d.value=S),type:s.value.allowEmailLogin&&!s.value.allowUsernameLogin?"email":"text",required:"",class:"input",placeholder:A.value},null,8,be),[[W,d.value]])]),e("div",null,[e("label",xe,[w(l(X),{class:"w-4 h-4 inline mr-2"}),L(" "+r(o.$t("auth.password")),1)]),M(e("input",{"onUpdate:modelValue":p[1]||(p[1]=S=>i.value=S),type:"password",required:"",class:"input",placeholder:"••••••••"},null,512),[[G,i.value]])]),v.value?(a(),n("div",_e,[w(l(Y),{class:"w-5 h-5"}),e("span",null,r(v.value),1)])):f("",!0),e("button",{type:"submit",disabled:t.value,class:"btn btn-primary w-full flex items-center justify-center gap-2"},[t.value?(a(),n("div",Ce)):(a(),k(l(te),{key:1,class:"w-5 h-5"})),L(" "+r(t.value?o.$t("common.loading"):o.$t("auth.loginButton")),1)],8,Le),x.value?(a(),n("div",$e,[p[2]||(p[2]=e("div",{class:"absolute inset-0 flex items-center"},[e("div",{class:"w-full border-t border-gray-700"})],-1)),e("div",Ue,[e("span",Se,r(o.$t("auth.or")),1)])])):f("",!0),x.value?(a(),n("button",{key:2,type:"button",onClick:j,disabled:t.value,class:"btn btn-outline w-full flex items-center justify-center gap-2"},[t.value?(a(),n("div",je)):(a(),k(l(Z),{key:1,class:"w-5 h-5"})),L(" "+r(t.value?o.$t("common.loading"):o.$t("auth.passkeyLogin")),1)],8,Ee)):f("",!0)],32)])]))}};export{Ne as default};
