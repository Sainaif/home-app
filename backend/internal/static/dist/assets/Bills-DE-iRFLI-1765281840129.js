import{c as q,i as et,j as tt,r as v,l as H,o as st,A as g,b as a,e as t,g as p,q as c,t as n,u,f as b,v as $,n as j,R as lt,p as V,X as ve,E as w,y as f,s as D,G as ye,F as h,h as k,m as nt,d as o,I as xe}from"./index-Hs7aDjjl-1765281840129.js";import{P as te}from"./plus-TOiVnhTe-1765281840129.js";import{C as Te}from"./circle-alert-BgqgMps3-1765281840129.js";import{F as se,Z as De,a as Ae,W as Ue}from"./zap-CruOimIk-1765281840129.js";/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=q("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=q("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=q("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=q("gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=q("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=q("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),rt={class:"page-header"},ut={class:"text-4xl font-bold gradient-text mb-2"},dt={class:"text-gray-400"},ct={class:"flex gap-2 mb-6"},pt={class:"card max-w-lg w-full mx-4"},mt={class:"flex justify-between items-center mb-6"},vt={class:"text-2xl font-bold gradient-text"},yt={class:"block text-sm font-medium mb-2"},bt={value:"electricity"},ft={value:"gas"},gt={value:"internet"},ht={value:"inne"},_t={key:0},$t={class:"block text-sm font-medium mb-2"},kt=["placeholder"],wt={key:1},xt={class:"block text-sm font-medium mb-2"},Tt={value:"simple"},Dt={value:"metered"},At={class:"block text-sm font-medium mb-2"},Ut={key:2},Ft={class:"block text-sm font-medium mb-2"},Nt={class:"grid grid-cols-2 gap-4"},jt={class:"block text-sm font-medium mb-2"},Vt={class:"block text-sm font-medium mb-2"},Ct={class:"block text-sm font-medium mb-2"},It={class:"block text-sm font-medium mb-2"},Rt=["placeholder"],St={key:3,class:"flex items-center gap-2 p-3 rounded-xl bg-red-500/10 border border-red-500/30 text-red-400 text-sm"},Mt={class:"flex gap-3"},Bt=["disabled"],Pt={key:0,class:"loading-spinner"},qt={class:"card mb-6"},Lt={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},Et={class:"block text-sm font-medium mb-2"},Ot={value:""},Gt={value:"electricity"},Yt={value:"gas"},zt={value:"internet"},Ht={value:"inne"},Wt={class:"block text-sm font-medium mb-2"},Xt={class:"block text-sm font-medium mb-2"},Zt={class:"block text-sm font-medium mb-2"},Jt={value:"date-desc"},Kt={value:"date-asc"},Qt={value:"amount-desc"},es={value:"amount-asc"},ts={class:"card"},ss={key:0,class:"flex justify-center py-12"},ls={key:1,class:"text-center py-12 text-gray-500"},ns={class:"text-lg"},os={class:"md:hidden space-y-3"},as=["onClick"],is={class:"flex items-start justify-between mb-3"},rs={class:"flex items-center gap-3"},us={class:"font-medium text-sm"},ds={class:"text-xs text-gray-400"},cs={class:"flex items-center justify-between"},ps={class:"text-lg font-bold text-purple-400"},ms={key:0,class:"text-sm text-gray-300"},vs=["onClick"],ys=["onClick"],bs=["onClick"],fs={class:"table-wrapper hidden md:block"},gs={key:0},hs=["onClick"],_s={class:"flex items-center gap-3"},$s={class:"font-medium"},ks={class:"flex items-center gap-2"},ws={class:"flex items-center gap-2"},xs={class:"font-bold text-purple-400"},Ts=["onClick"],Ds={class:"text-gray-300"},As={class:"text-gray-400 text-sm"},Us={class:"flex items-center gap-2"},Fs=["onClick"],Ns=["onClick"],js=["onClick"],Vs={key:0,class:"bg-gray-800/30"},Cs={colspan:"7",class:"p-4"},Is={key:0,class:"text-center text-gray-400"},Rs={key:1,class:"space-y-2"},Ss={class:"text-sm font-semibold text-purple-400 mb-3"},Ms={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},Bs={class:"flex justify-between items-start"},Ps={class:"font-medium text-white"},qs={class:"text-xs text-gray-400"},Ls={class:"text-right"},Es={class:"font-bold text-purple-400"},Os={key:0,class:"text-xs text-gray-400"},Gs={key:0,class:"mt-2 pt-2 border-t border-gray-700/50 text-xs text-gray-400 space-y-1"},Ys={class:"flex justify-between"},zs={class:"flex justify-between"},Hs={key:1,class:"mt-2 pt-2 border-t border-gray-700/50 text-center"},Ws={class:"text-xs text-green-400"},Xs={key:2,class:"mt-2 pt-2 border-t border-gray-700/50 text-center"},Zs={class:"text-xs text-yellow-400"},Js={key:2,class:"text-center text-gray-400"},Ks={class:"card mb-6"},Qs={class:"text-xl font-semibold mb-4"},el={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},tl={class:"block text-sm font-medium mb-2"},sl={value:""},ll=["value"],nl={class:"block text-sm font-medium mb-2"},ol={class:"block text-sm font-medium mb-2"},al=["disabled"],il={class:"card mb-6"},rl={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ul={class:"block text-sm font-medium mb-2"},dl={value:""},cl=["value"],pl={class:"block text-sm font-medium mb-2"},ml={value:""},vl=["label"],yl=["value"],bl=["label"],fl=["value"],gl={class:"block text-sm font-medium mb-2"},hl={value:"date-desc"},_l={value:"date-asc"},$l={value:"value-desc"},kl={value:"value-asc"},wl={class:"card"},xl={class:"text-xl font-semibold mb-4"},Tl={key:0,class:"text-center py-8"},Dl={key:1,class:"text-center py-8 text-gray-400"},Al={key:2,class:"space-y-3"},Ul=["onClick"],Fl={class:"font-medium"},Nl={class:"text-gray-400 text-sm ml-4"},jl={key:0,class:"text-blue-400 text-sm ml-4"},Vl={class:"text-sm text-gray-400"},Cl={class:"card"},Il={class:"text-xl font-semibold mb-4"},Rl={key:0,class:"text-center py-8"},Sl={key:1,class:"text-center py-8 text-gray-400"},Ml={class:"text-sm mt-2"},Bl={key:2,class:"space-y-3"},Pl={class:"flex justify-between items-start"},ql={class:"flex-1"},Ll={class:"flex items-center gap-3 mb-2"},El={class:"text-lg font-semibold"},Ol={class:"px-2 py-1 rounded text-xs bg-purple-500/20 text-purple-400"},Gl={class:"grid grid-cols-2 gap-4 text-sm"},Yl={class:"text-gray-400"},zl={class:"ml-2 font-medium"},Hl={class:"text-gray-400"},Wl={class:"ml-2 font-medium"},Xl={class:"text-gray-400"},Zl={class:"ml-2 font-medium"},Jl={key:0},Kl={class:"text-gray-400"},Ql={class:"ml-2 font-medium"},en={key:0,class:"mt-3"},tn={class:"text-gray-400 text-sm"},sn={class:"flex flex-wrap gap-2 mt-1"},ln={key:1,class:"mt-2 text-sm text-gray-400"},nn={class:"flex gap-2 ml-4"},on=["onClick"],an=["onClick"],rn={class:"card max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"},un={class:"flex justify-between items-center mb-6"},dn={class:"text-2xl font-bold gradient-text"},cn={class:"block text-sm font-medium mb-2"},pn=["placeholder"],mn={class:"grid grid-cols-2 gap-4"},vn={class:"block text-sm font-medium mb-2"},yn={class:"block text-sm font-medium mb-2"},bn={value:"monthly"},fn={value:"quarterly"},gn={value:"yearly"},hn={class:"grid grid-cols-2 gap-4"},_n={class:"block text-sm font-medium mb-2"},$n={class:"text-xs text-gray-400 mt-1"},kn={class:"block text-sm font-medium mb-2"},wn={class:"text-xs text-gray-400 mt-1"},xn={class:"block text-sm font-medium mb-2"},Tn={class:"space-y-3"},Dn={class:"flex gap-2"},An=["onUpdate:modelValue","onChange"],Un={value:"user"},Fn={value:"group"},Nn=["onUpdate:modelValue"],jn={value:""},Vn=["value"],Cn=["value"],In=["onClick"],Rn={class:"flex gap-2 items-center"},Sn=["onUpdate:modelValue"],Mn={value:"percentage"},Bn={value:"fraction"},Pn={value:"fixed"},qn={key:0,class:"flex items-center gap-2 flex-1"},Ln=["onUpdate:modelValue"],En={key:1,class:"flex items-center gap-2 flex-1"},On=["onUpdate:modelValue"],Gn=["onUpdate:modelValue"],Yn={key:2,class:"flex items-center gap-2 flex-1"},zn=["onUpdate:modelValue"],Hn={key:0,class:"text-xs text-yellow-400"},Wn={class:"block text-sm font-medium mb-2"},Xn=["placeholder"],Zn={key:0,class:"flex items-center gap-2 p-3 rounded-xl bg-red-500/10 border border-red-500/30 text-red-400 text-sm"},Jn={class:"flex gap-3 justify-end pt-4"},Kn=["disabled"],Qn=.01,ao={__name:"Bills",setup(eo){const je=nt(),{t:y,locale:fe}=et(),C=tt(),x=v("bills"),W=v([]);v([]);const le=v(!1),R=v(!1),F=v(!1),N=v(""),S=v({}),ne=v({}),oe=v({}),L=v({}),_=v({type:"",dateFrom:"",dateTo:"",sortBy:"date-desc"}),E=v([]),ae=v([]),ie=v([]),I=v([]),re=v(!1),ue=v(!1),T=v({billId:"",subjectId:"",sortBy:"date-desc"}),A=v({billId:"",meterReading:"",readingDate:new Date().toISOString().slice(0,16)}),X=v([]),de=v(!1),Z=v(!1),O=v(!1),M=v(null),B=v(""),P=v([]),m=v({customType:"",frequency:"monthly",amount:"",dayOfMonth:1,startDate:"",allocations:[],notes:""}),ce=H(()=>{if(m.value.allocations.length===0)return!1;let e=0,l=!1;for(const s of m.value.allocations)if(s.allocationType==="percentage")e+=(parseFloat(s.percentage)||0)/100,l=!0;else if(s.allocationType==="fraction"){const i=parseInt(s.fractionNum)||0,r=parseInt(s.fractionDenom)||1;e+=i/r,l=!0}return l?e>=.999&&e<=1.001:!0}),ge=H(()=>{if(m.value.allocations.length===0)return y("bills.addAllocationRequired");let e=0,l=!1;for(const s of m.value.allocations)if(s.allocationType==="percentage")e+=(parseFloat(s.percentage)||0)/100,l=!0;else if(s.allocationType==="fraction"){const i=parseInt(s.fractionNum)||0,r=parseInt(s.fractionDenom)||1;e+=i/r,l=!0}return l?y("bills.allocationTotal",{total:(e*100).toFixed(2)}):""}),J=H(()=>{let e=[...W.value].filter(l=>l&&l.id);if(_.value.type&&(e=e.filter(l=>l.type===_.value.type)),_.value.dateFrom){const l=new Date(_.value.dateFrom);e=e.filter(s=>new Date(s.periodEnd)>=l)}if(_.value.dateTo){const l=new Date(_.value.dateTo);e=e.filter(s=>new Date(s.periodStart)<=l)}return e.sort((l,s)=>{switch(_.value.sortBy){case"date-desc":return new Date(s.periodEnd)-new Date(l.periodEnd);case"date-asc":return new Date(l.periodEnd)-new Date(s.periodEnd);case"amount-desc":return s.totalAmountPLN-l.totalAmountPLN;case"amount-asc":return l.totalAmountPLN-s.totalAmountPLN;default:return 0}}),e}),Ve=H(()=>W.value.some(e=>e.type==="electricity"||e.type==="inne"&&e.allocationType==="metered")),he=H(()=>{let e=[...ie.value];return T.value.billId&&(e=e.filter(l=>l.billId===T.value.billId)),T.value.subjectId&&(e=e.filter(l=>l.subjectId===T.value.subjectId)),e.sort((l,s)=>{switch(T.value.sortBy){case"date-desc":return new Date(s.recordedAt)-new Date(l.recordedAt);case"date-asc":return new Date(l.recordedAt)-new Date(s.recordedAt);case"value-desc":return s.meterValue-l.meterValue;case"value-asc":return l.meterValue-s.meterValue;default:return 0}}),e}),d=v({type:"electricity",customType:"",allocationType:"simple",totalAmountPLN:"",totalUnits:"",periodStart:"",periodEnd:"",paymentDeadline:"",notes:""});st(async()=>{await G(),await Y(),await me(),await Ee()});async function G(){le.value=!0;try{const e=await g.get("/bills");W.value=e.data||[]}catch(e){console.error("Failed to load bills:",e),W.value=[]}finally{le.value=!1}}async function Y(){re.value=!0;try{const e=await g.get("/bills?status=posted");ae.value=(e.data||[]).filter(r=>r.type==="electricity"||r.type==="inne"&&r.allocationType==="metered");const l=await g.get("/bills");E.value=l.data||[];const s=await g.get("/consumptions");ie.value=s.data||[];const i=await g.get("/users");I.value=i.data||[]}catch(e){console.error("Failed to load readings data:",e),ae.value=[],E.value=[],ie.value=[],I.value=[]}finally{re.value=!1}}async function Ce(){F.value=!0,N.value="";try{const e=new Date(d.value.periodStart),l=new Date(d.value.periodEnd),i=new Date().getFullYear()+2;if(isNaN(e.getTime())||isNaN(l.getTime())){N.value=y("errors.invalidDates"),F.value=!1;return}if(e.getFullYear()<2e3||e.getFullYear()>i){N.value=y("errors.startDateRange",{maxYear:i}),F.value=!1;return}if(l.getFullYear()<2e3||l.getFullYear()>i){N.value=y("errors.endDateRange",{maxYear:i}),F.value=!1;return}if(l<=e){N.value=y("errors.endBeforeStart"),F.value=!1;return}const r={type:d.value.type,totalAmountPLN:d.value.totalAmountPLN,totalUnits:d.value.totalUnits||void 0,periodStart:e.toISOString(),periodEnd:l.toISOString(),notes:d.value.notes||void 0};d.value.type==="inne"&&d.value.customType&&(r.customType=d.value.customType,r.allocationType=d.value.allocationType),await g.post("/bills",r),R.value=!1,await G(),await Y(),d.value={type:"electricity",customType:"",allocationType:"simple",totalAmountPLN:"",totalUnits:"",periodStart:"",periodEnd:"",notes:""}}catch(e){N.value=e.response?.data?.error||y("errors.createBillFailed")}finally{F.value=!1}}async function _e(e){try{await g.post(`/bills/${e}/post`),await G(),await Y()}catch(l){console.error("Failed to post bill:",l)}}async function $e(e){try{await g.post(`/bills/${e}/close`),await G()}catch(l){console.error("Failed to close bill:",l)}}async function ke(e){if(confirm(y("bills.confirmDelete")))try{await g.delete(`/bills/${e}`),await G(),await Y()}catch(l){console.error("Failed to delete bill:",l),alert(y("errors.deleteFailed")+" "+(l.response?.data?.error||l.message))}}async function Ie(){ue.value=!0;try{const e=parseFloat(A.value.meterReading);if(isNaN(e)||e<=0)throw new Error(y("errors.invalidConsumption"));await g.post("/consumptions",{billId:A.value.billId,units:e,meterValue:e,recordedAt:new Date(A.value.readingDate).toISOString()}),A.value.meterReading="",await Y()}catch(e){console.error("Failed to submit reading:",e),alert(y("errors.saveReadingFailed")+" "+(e.response?.data?.error||e.message))}finally{ue.value=!1}}function z(e){return e?typeof e=="number"?e.toFixed(2):parseFloat(e.$numberDecimal||e||0).toFixed(2):"0.00"}function pe(e){return e?typeof e=="number"?e.toFixed(3):parseFloat(e.$numberDecimal||e||0).toFixed(3):"0.000"}function Re(e){return e?parseFloat(e.$numberDecimal||e||0).toFixed(3):"0.000"}function U(e){if(!e)return"-";const s={pl:"pl-PL",en:"en-US"}[fe.value]||"en-US";return new Date(e).toLocaleDateString(s,{day:"numeric",month:"short",year:"numeric"})}async function Se(e){if(!S.value[e]){oe.value[e]=!0;try{const[l,s]=await Promise.all([g.get(`/bills/${e}/allocation`),g.get(`/payments/bill/${e}`)]);S.value[e]=l.data,ne.value[e]=s.data||[]}catch(l){console.error("Failed to load allocation:",l),S.value[e]=[],ne.value[e]=[]}finally{oe.value[e]=!1}}}async function Me(e){L.value[e]?L.value[e]=!1:(L.value[e]=!0,await Se(e))}function Be(e){if(!e)return"-";const s={pl:"pl-PL",en:"en-US"}[fe.value]||"en-US";return new Date(e).toLocaleString(s)}function K(e){return e==="electricity"?"kWh":e==="gas"?"m³":""}function Pe(e){const l=E.value.find(s=>s.id===e);return l&&K(l.type)||y("common.units")}function qe(e,l){if(l==="group"){const s=P.value.find(i=>i.id===e);return s?s.name:y("errors.unknownGroup")}else{const s=I.value.find(i=>i.id===e);return s?s.name:y("errors.unknown")}}function we(e){const l=E.value.find(r=>r.id===e);if(!l)return"";const s=y(`bills.${l.type}`,l.type),i=`${U(l.periodStart)} - ${U(l.periodEnd)}`;return`${s}: ${i}`}function Le(e){je.push(`/bills/${e}`)}async function me(){de.value=!0;try{const e=await g.get("/recurring-bills");X.value=e.data||[]}catch(e){console.error("Failed to load recurring templates:",e),X.value=[]}finally{de.value=!1}}async function Ee(){try{const e=await g.get("/groups");P.value=e.data||[]}catch(e){console.error("Failed to load groups:",e),P.value=[]}}function Oe(){m.value.allocations.push({subjectType:"user",subjectId:"",allocationType:"fraction",percentage:null,fractionNum:1,fractionDenom:1,fixedAmount:null})}function Ge(e){m.value.allocations.splice(e,1)}function Q(){Z.value=!1,M.value=null,B.value="",m.value={customType:"",frequency:"monthly",amount:"",dayOfMonth:1,startDate:"",allocations:[],notes:""}}async function Ye(){O.value=!0,B.value="";try{if(!ce.value){B.value=ge.value||"Nieprawidłowe alokacje",O.value=!1;return}const e={customType:m.value.customType,frequency:m.value.frequency,amount:parseFloat(m.value.amount).toFixed(2),dayOfMonth:parseInt(m.value.dayOfMonth),startDate:m.value.startDate?new Date(m.value.startDate).toISOString():void 0,allocations:m.value.allocations.map(l=>{const s={subjectType:l.subjectType,subjectId:l.subjectId,allocationType:l.allocationType};return l.allocationType==="percentage"?s.percentage=parseFloat(l.percentage):l.allocationType==="fraction"?(s.fractionNumerator=parseInt(l.fractionNum),s.fractionDenominator=parseInt(l.fractionDenom)):l.allocationType==="fixed"&&(s.fixedAmount=parseFloat(l.fixedAmount).toFixed(2)),s}),notes:m.value.notes||void 0};M.value?await g.patch(`/recurring-bills/${M.value}`,e):await g.post("/recurring-bills",e),await me(),Q()}catch(e){B.value=e.response?.data?.error||y("errors.saveTemplateFailed")}finally{O.value=!1}}function ze(e){M.value=e.id,m.value={customType:e.customType,frequency:e.frequency,amount:ee(e.amount),dayOfMonth:e.dayOfMonth,startDate:e.startDate?new Date(e.startDate).toISOString().split("T")[0]:"",allocations:e.allocations.map(l=>({subjectType:l.subjectType,subjectId:l.subjectId,allocationType:l.allocationType,percentage:l.percentage||null,fractionNum:l.fractionNumerator||1,fractionDenom:l.fractionDenominator||1,fixedAmount:l.fixedAmount?ee(l.fixedAmount):null})),notes:e.notes||""},Z.value=!0}async function He(e){if(confirm(y("bills.confirmDeleteRecurring")))try{await g.delete(`/recurring-bills/${e}`),await me()}catch(l){console.error("Failed to delete recurring template:",l),alert(y("errors.deleteTemplateFailed"))}}function We(e){return y(`bills.${e}`,e)}function ee(e){if(!e)return"0.00";const l=String(e).replace(/["{}$numberDecimal:]/g,"");return parseFloat(l).toFixed(2)}function Xe(e){const l=e.subjectType==="user"?I.value.find(r=>r.id===e.subjectId):P.value.find(r=>r.id===e.subjectId),s=l?l.name||l.email:y("errors.unknown");let i="";return e.allocationType==="percentage"?i=`${e.percentage}%`:e.allocationType==="fraction"?i=`${e.fractionNumerator}/${e.fractionDenominator}`:e.allocationType==="fixed"&&(i=`${ee(e.fixedAmount)} PLN`),`${s}: ${i}`}function Ze(e,l){const s=ne.value[e];if(!s||!s.length)return!1;const i=Number(l.amount||0);if(!i)return!1;const r=l.subjectType==="group"?Je(l.subjectId):[l.subjectId];return r.length?Ke(s,r)+Qn>=i:!1}function Je(e){return e?I.value.filter(l=>l.groupId===e).map(l=>l.id):[]}function Ke(e,l){return e.reduce((s,i)=>(l.includes(i.payerUserId)&&(s+=Qe(i.amountPLN)),s),0)}function Qe(e){return e==null?0:typeof e=="number"?e:typeof e=="string"?parseFloat(e):typeof e=="object"&&e.$numberDecimal?parseFloat(e.$numberDecimal):0}return(e,l)=>(o(),a("div",null,[t("div",rt,[t("div",null,[t("h1",ut,n(e.$t("bills.title")),1),t("p",dt,n(e.$t("bills.description")),1)]),u(C).hasPermission("bills.create")&&x.value==="bills"?(o(),a("button",{key:0,onClick:l[0]||(l[0]=s=>R.value=!0),class:"btn btn-primary flex items-center gap-2"},[b(u(te),{class:"w-5 h-5"}),$(" "+n(e.$t("bills.createNew")),1)])):p("",!0),u(C).hasPermission("bills.create")&&x.value==="recurring"?(o(),a("button",{key:1,onClick:l[1]||(l[1]=s=>Z.value=!0),class:"btn btn-primary flex items-center gap-2"},[b(u(te),{class:"w-5 h-5"}),$(" "+n(e.$t("bills.createRecurring")),1)])):p("",!0)]),t("div",ct,[t("button",{onClick:l[2]||(l[2]=s=>x.value="bills"),class:j([["btn",x.value==="bills"?"btn-primary":"btn-outline"],"flex items-center gap-2"])},[b(u(lt),{class:"w-4 h-4"}),$(" "+n(e.$t("bills.tabBills")),1)],2),Ve.value?(o(),a("button",{key:0,onClick:l[3]||(l[3]=s=>x.value="readings"),class:j([["btn",x.value==="readings"?"btn-primary":"btn-outline"],"flex items-center gap-2"])},[b(u(it),{class:"w-4 h-4"}),$(" "+n(e.$t("bills.tabReadings")),1)],2)):p("",!0),u(C).hasPermission("bills.create")?(o(),a("button",{key:1,onClick:l[4]||(l[4]=s=>x.value="recurring"),class:j([["btn",x.value==="recurring"?"btn-primary":"btn-outline"],"flex items-center gap-2"])},[b(u(Fe),{class:"w-4 h-4"}),$(" "+n(e.$t("bills.tabRecurring")),1)],2)):p("",!0)]),R.value?(o(),a("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",onClick:l[16]||(l[16]=V(s=>R.value=!1,["self"]))},[t("div",pt,[t("div",mt,[t("h2",vt,n(e.$t("bills.createNew")),1),t("button",{onClick:l[5]||(l[5]=s=>R.value=!1),class:"text-gray-400 hover:text-white"},[b(u(ve),{class:"w-6 h-6"})])]),t("form",{onSubmit:V(Ce,["prevent"]),class:"space-y-4"},[t("div",null,[t("label",yt,n(e.$t("bills.type")),1),c(t("select",{"onUpdate:modelValue":l[6]||(l[6]=s=>d.value.type=s),required:"",class:"input"},[t("option",bt,n(e.$t("bills.electricity")),1),t("option",ft,n(e.$t("bills.gas")),1),t("option",gt,n(e.$t("bills.internet")),1),t("option",ht,n(e.$t("bills.inne")),1)],512),[[w,d.value.type]])]),d.value.type==="inne"?(o(),a("div",_t,[t("label",$t,n(e.$t("bills.customTypeName")),1),c(t("input",{"onUpdate:modelValue":l[7]||(l[7]=s=>d.value.customType=s),type:"text",required:"",class:"input",placeholder:e.$t("bills.customTypeExample")},null,8,kt),[[f,d.value.customType]])])):p("",!0),d.value.type==="inne"?(o(),a("div",wt,[t("label",xt,n(e.$t("bills.allocationMethod")),1),c(t("select",{"onUpdate:modelValue":l[8]||(l[8]=s=>d.value.allocationType=s),required:"",class:"input"},[t("option",Tt,n(e.$t("bills.allocationSimple")),1),t("option",Dt,n(e.$t("bills.allocationMetered")),1)],512),[[w,d.value.allocationType]])])):p("",!0),t("div",null,[t("label",At,n(e.$t("bills.amount")),1),c(t("input",{"onUpdate:modelValue":l[9]||(l[9]=s=>d.value.totalAmountPLN=s),type:"number",step:"0.01",required:"",class:"input",placeholder:"150.00"},null,512),[[f,d.value.totalAmountPLN,void 0,{number:!0}]])]),d.value.type==="electricity"||d.value.type==="gas"||d.value.type==="inne"&&d.value.allocationType==="metered"?(o(),a("div",Ut,[t("label",Ft,n(e.$t("bills.units")),1),c(t("input",{"onUpdate:modelValue":l[10]||(l[10]=s=>d.value.totalUnits=s),type:"number",step:"0.001",class:"input",placeholder:"100.000"},null,512),[[f,d.value.totalUnits,void 0,{number:!0}]])])):p("",!0),t("div",Nt,[t("div",null,[t("label",jt,n(e.$t("bills.periodStart")),1),c(t("input",{"onUpdate:modelValue":l[11]||(l[11]=s=>d.value.periodStart=s),type:"date",required:"",class:"input",min:"2000-01-01",max:"2099-12-31"},null,512),[[f,d.value.periodStart]])]),t("div",null,[t("label",Vt,n(e.$t("bills.periodEnd")),1),c(t("input",{"onUpdate:modelValue":l[12]||(l[12]=s=>d.value.periodEnd=s),type:"date",required:"",class:"input",min:"2000-01-01",max:"2099-12-31"},null,512),[[f,d.value.periodEnd]])])]),t("div",null,[t("label",Ct,n(e.$t("bills.paymentDeadline")),1),c(t("input",{"onUpdate:modelValue":l[13]||(l[13]=s=>d.value.paymentDeadline=s),type:"date",class:"input",min:"2000-01-01",max:"2099-12-31"},null,512),[[f,d.value.paymentDeadline]])]),t("div",null,[t("label",It,n(e.$t("bills.notes")),1),c(t("textarea",{"onUpdate:modelValue":l[14]||(l[14]=s=>d.value.notes=s),class:"input",rows:"3",placeholder:e.$t("bills.notesPlaceholder")},null,8,Rt),[[f,d.value.notes]])]),N.value?(o(),a("div",St,[b(u(Te),{class:"w-4 h-4"}),$(" "+n(N.value),1)])):p("",!0),t("div",Mt,[t("button",{type:"submit",disabled:F.value,class:"btn btn-primary flex-1 flex items-center justify-center gap-2"},[F.value?(o(),a("div",Pt)):(o(),D(u(te),{key:1,class:"w-5 h-5"})),$(" "+n(F.value?e.$t("common.creating"):e.$t("bills.createButton")),1)],8,Bt),t("button",{type:"button",onClick:l[15]||(l[15]=s=>R.value=!1),class:"btn btn-outline"},n(e.$t("common.cancel")),1)])],32)])])):p("",!0),c(t("div",null,[t("div",qt,[t("div",Lt,[t("div",null,[t("label",Et,n(e.$t("bills.type")),1),c(t("select",{"onUpdate:modelValue":l[17]||(l[17]=s=>_.value.type=s),class:"input"},[t("option",Ot,n(e.$t("common.all")),1),t("option",Gt,n(e.$t("bills.electricity")),1),t("option",Yt,n(e.$t("bills.gas")),1),t("option",zt,n(e.$t("bills.internet")),1),t("option",Ht,n(e.$t("bills.inne")),1)],512),[[w,_.value.type]])]),t("div",null,[t("label",Wt,n(e.$t("bills.dateFrom")),1),c(t("input",{"onUpdate:modelValue":l[18]||(l[18]=s=>_.value.dateFrom=s),type:"date",class:"input"},null,512),[[f,_.value.dateFrom]])]),t("div",null,[t("label",Xt,n(e.$t("bills.dateTo")),1),c(t("input",{"onUpdate:modelValue":l[19]||(l[19]=s=>_.value.dateTo=s),type:"date",class:"input"},null,512),[[f,_.value.dateTo]])]),t("div",null,[t("label",Zt,n(e.$t("bills.sortBy")),1),c(t("select",{"onUpdate:modelValue":l[20]||(l[20]=s=>_.value.sortBy=s),class:"input"},[t("option",Jt,n(e.$t("bills.sortDateNewest")),1),t("option",Kt,n(e.$t("bills.sortDateOldest")),1),t("option",Qt,n(e.$t("bills.sortAmountDesc")),1),t("option",es,n(e.$t("bills.sortAmountAsc")),1)],512),[[w,_.value.sortBy]])])])]),t("div",ts,[le.value?(o(),a("div",ss,[...l[35]||(l[35]=[t("div",{class:"loading-spinner"},null,-1)])])):J.value.length===0?(o(),a("div",ls,[b(u(se),{class:"w-16 h-16 mx-auto mb-4 opacity-50"}),t("p",ns,n(e.$t("bills.noBills")),1)])):(o(),a(h,{key:2},[t("div",os,[(o(!0),a(h,null,k(J.value,s=>(o(),a("div",{key:s.id,onClick:i=>e.$router.push(`/bills/${s.id}`),class:"p-4 bg-gray-700/50 rounded-lg border border-gray-600/50 hover:bg-gray-700 transition-colors cursor-pointer"},[t("div",is,[t("div",rs,[t("div",{class:j(["w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",{"bg-yellow-600/20":s.type==="electricity","bg-orange-600/20":s.type==="gas","bg-blue-600/20":s.type==="internet","bg-purple-600/20":s.type==="inne"}])},[s.type==="electricity"?(o(),D(u(De),{key:0,class:"w-5 h-5 text-yellow-400"})):s.type==="gas"?(o(),D(u(Ae),{key:1,class:"w-5 h-5 text-orange-400"})):s.type==="internet"?(o(),D(u(Ue),{key:2,class:"w-5 h-5 text-blue-400"})):(o(),D(u(se),{key:3,class:"w-5 h-5 text-purple-400"}))],2),t("div",null,[t("div",us,n(s.type==="inne"&&s.customType?s.customType:e.$t(`bills.${s.type}`)),1),t("div",ds,n(U(s.periodStart))+" - "+n(U(s.periodEnd)),1)])]),t("span",{class:j(`badge badge-${s.status} text-xs`)},n(e.$t(`bills.${s.status}`)),3)]),t("div",cs,[t("span",ps,n(z(s.totalAmountPLN))+" PLN",1),s.totalUnits?(o(),a("span",ms,n(pe(s.totalUnits))+" "+n(K(s.type)),1)):p("",!0)]),u(C).isAdmin?(o(),a("div",{key:0,class:"flex items-center gap-2 mt-3 pt-3 border-t border-gray-600/50",onClick:l[21]||(l[21]=V(()=>{},["stop"]))},[s.status==="draft"?(o(),a("button",{key:0,onClick:i=>_e(s.id),class:"btn btn-sm btn-primary flex items-center gap-1 flex-1"},[b(u(Ne),{class:"w-3 h-3"}),$(" "+n(e.$t("bills.postButton")),1)],8,vs)):p("",!0),s.status==="posted"?(o(),a("button",{key:1,onClick:i=>$e(s.id),class:"btn btn-sm btn-secondary flex items-center gap-1 flex-1"},[b(u(xe),{class:"w-3 h-3"}),$(" "+n(e.$t("bills.closeButton")),1)],8,ys)):p("",!0),t("button",{onClick:i=>ke(s.id),class:"btn btn-sm bg-red-600/20 hover:bg-red-600/30 text-red-400 flex items-center gap-1"},[b(u(be),{class:"w-3 h-3"})],8,bs)])):p("",!0)],8,as))),128))]),t("div",fs,[t("table",null,[t("thead",null,[t("tr",null,[t("th",null,n(e.$t("bills.type")),1),t("th",null,n(e.$t("bills.period")),1),t("th",null,n(e.$t("bills.amount")),1),t("th",null,n(e.$t("bills.totalUnits")),1),t("th",null,n(e.$t("common.description")),1),t("th",null,n(e.$t("bills.status")),1),u(C).isAdmin?(o(),a("th",gs,n(e.$t("common.actions")),1)):p("",!0)])]),t("tbody",null,[(o(!0),a(h,null,k(J.value,s=>(o(),a("tr",{key:s.id,onClick:i=>e.$router.push(`/bills/${s.id}`),class:"cursor-pointer"},[t("td",null,[t("div",_s,[t("div",{class:j(["w-10 h-10 rounded-lg flex items-center justify-center",{"bg-yellow-600/20":s.type==="electricity","bg-orange-600/20":s.type==="gas","bg-blue-600/20":s.type==="internet","bg-purple-600/20":s.type==="inne"}])},[s.type==="electricity"?(o(),D(u(De),{key:0,class:"w-5 h-5 text-yellow-400"})):s.type==="gas"?(o(),D(u(Ae),{key:1,class:"w-5 h-5 text-orange-400"})):s.type==="internet"?(o(),D(u(Ue),{key:2,class:"w-5 h-5 text-blue-400"})):(o(),D(u(se),{key:3,class:"w-5 h-5 text-purple-400"}))],2),t("div",null,[t("span",$s,n(s.type==="inne"&&s.customType?s.customType:e.$t(`bills.${s.type}`)),1)])])]),t("td",null,[t("div",ks,[b(u(Fe),{class:"w-4 h-4 text-gray-500"}),t("span",null,n(U(s.periodStart))+" - "+n(U(s.periodEnd)),1)])]),t("td",null,[t("div",ws,[t("span",xs,n(z(s.totalAmountPLN))+" PLN",1),t("button",{onClick:V(i=>Me(s.id),["stop"]),class:"text-gray-400 hover:text-purple-400 transition-colors"},[L.value[s.id]?(o(),D(u(at),{key:1,class:"w-4 h-4"})):(o(),D(u(ot),{key:0,class:"w-4 h-4"}))],8,Ts)])]),t("td",null,[t("span",Ds,n(s.totalUnits?pe(s.totalUnits)+" "+K(s.type):"-"),1)]),t("td",null,[t("span",As,n(s.notes||"-"),1)]),t("td",null,[t("span",{class:j(`badge badge-${s.status}`)},n(e.$t(`bills.${s.status}`)),3)]),u(C).isAdmin?(o(),a("td",{key:0,onClick:l[22]||(l[22]=V(()=>{},["stop"]))},[t("div",Us,[s.status==="draft"?(o(),a("button",{key:0,onClick:i=>_e(s.id),class:"btn btn-sm btn-primary flex items-center gap-1"},[b(u(Ne),{class:"w-3 h-3"}),$(" "+n(e.$t("bills.post")),1)],8,Fs)):p("",!0),s.status==="posted"?(o(),a("button",{key:1,onClick:i=>$e(s.id),class:"btn btn-sm btn-secondary flex items-center gap-1"},[b(u(xe),{class:"w-3 h-3"}),$(" "+n(e.$t("bills.close")),1)],8,Ns)):p("",!0),t("button",{onClick:i=>ke(s.id),class:"btn btn-sm bg-red-600/20 hover:bg-red-600/30 text-red-400 flex items-center gap-1"},[b(u(be),{class:"w-3 h-3"}),$(" "+n(e.$t("bills.deleteButton")),1)],8,js)])])):p("",!0)],8,hs))),128)),(o(!0),a(h,null,k(J.value,s=>(o(),a(h,{key:s.id+"-allocation"},[L.value[s.id]?(o(),a("tr",Vs,[t("td",Cs,[oe.value[s.id]?(o(),a("div",Is,n(e.$t("bills.loadingAllocation")),1)):S.value[s.id]&&S.value[s.id].length>0?(o(),a("div",Rs,[t("h3",Ss,n(e.$t("bills.allocationBreakdown")),1),t("div",Ms,[(o(!0),a(h,null,k(S.value[s.id],i=>(o(),a("div",{key:i.subjectId,class:"bg-gray-800/50 rounded-lg p-3 border border-gray-700/50"},[t("div",Bs,[t("div",null,[t("p",Ps,n(i.subjectName),1),t("p",qs,n(e.$t("bills.weight"))+" "+n(i.weight.toFixed(2)),1)]),t("div",Ls,[t("p",Es,n(z(i.amount))+" PLN",1),i.units!==void 0?(o(),a("div",Os,n(pe(i.units))+" "+n(K(s.type)),1)):p("",!0)])]),i.personalAmount!==void 0&&i.sharedAmount!==void 0?(o(),a("div",Gs,[t("div",Ys,[t("span",null,n(e.$t("bills.personal")),1),t("span",null,n(z(i.personalAmount))+" PLN",1)]),t("div",zs,[t("span",null,n(e.$t("bills.shared")),1),t("span",null,n(z(i.sharedAmount))+" PLN",1)])])):p("",!0),Ze(s.id,i)?(o(),a("div",Hs,[t("span",Ws,"✓ "+n(e.$t("bills.paid")),1)])):(o(),a("div",Xs,[t("span",Zs,"⏳ "+n(e.$t("bills.pendingPayment")),1)]))]))),128))])])):(o(),a("div",Js,n(e.$t("bills.noAllocationData")),1))])])):p("",!0)],64))),128))])])])],64))])],512),[[ye,x.value==="bills"]]),c(t("div",null,[t("div",Ks,[t("h2",Qs,n(e.$t("readings.addReading")),1),t("form",{onSubmit:V(Ie,["prevent"]),class:"space-y-4"},[t("div",el,[t("div",null,[t("label",tl,n(e.$t("readings.bill")),1),c(t("select",{"onUpdate:modelValue":l[23]||(l[23]=s=>A.value.billId=s),required:"",class:"input"},[t("option",sl,n(e.$t("common.select")),1),(o(!0),a(h,null,k(ae.value,s=>(o(),a("option",{key:s.id,value:s.id},n(e.$t(`bills.${s.type}`))+" - "+n(U(s.periodStart)),9,ll))),128))],512),[[w,A.value.billId]])]),t("div",null,[t("label",nl,n(e.$t("readings.meterReading")),1),c(t("input",{"onUpdate:modelValue":l[24]||(l[24]=s=>A.value.meterReading=s),type:"number",step:"0.001",required:"",class:"input"},null,512),[[f,A.value.meterReading,void 0,{number:!0}]])]),t("div",null,[t("label",ol,n(e.$t("readings.date")),1),c(t("input",{"onUpdate:modelValue":l[25]||(l[25]=s=>A.value.readingDate=s),type:"datetime-local",required:"",class:"input"},null,512),[[f,A.value.readingDate]])])]),t("button",{type:"submit",disabled:ue.value,class:"btn btn-primary"},n(e.$t("readings.submit")),9,al)],32)]),t("div",il,[t("div",rl,[t("div",null,[t("label",ul,n(e.$t("readings.bill")),1),c(t("select",{"onUpdate:modelValue":l[26]||(l[26]=s=>T.value.billId=s),class:"input"},[t("option",dl,n(e.$t("common.all")),1),(o(!0),a(h,null,k(E.value,s=>(o(),a("option",{key:s.id,value:s.id},n(e.$t(`bills.${s.type}`))+" - "+n(U(s.periodStart)),9,cl))),128))],512),[[w,T.value.billId]])]),t("div",null,[t("label",pl,n(e.$t("readings.personOrGroup")),1),c(t("select",{"onUpdate:modelValue":l[27]||(l[27]=s=>T.value.subjectId=s),class:"input"},[t("option",ml,n(e.$t("common.everyone")),1),t("optgroup",{label:e.$t("readings.groups")},[(o(!0),a(h,null,k(P.value,s=>(o(),a("option",{key:"group-"+s.id,value:s.id},n(s.name),9,yl))),128))],8,vl),t("optgroup",{label:e.$t("readings.users")},[(o(!0),a(h,null,k(I.value,s=>(o(),a("option",{key:"user-"+s.id,value:s.id},n(s.name),9,fl))),128))],8,bl)],512),[[w,T.value.subjectId]])]),t("div",null,[t("label",gl,n(e.$t("bills.sortBy")),1),c(t("select",{"onUpdate:modelValue":l[28]||(l[28]=s=>T.value.sortBy=s),class:"input"},[t("option",hl,n(e.$t("bills.sortDateNewest")),1),t("option",_l,n(e.$t("bills.sortDateOldest")),1),t("option",$l,n(e.$t("bills.sortAmountDesc")),1),t("option",kl,n(e.$t("bills.sortAmountAsc")),1)],512),[[w,T.value.sortBy]])])])]),t("div",wl,[t("h2",xl,n(e.$t("readings.recentReadings")),1),re.value?(o(),a("div",Tl,n(e.$t("common.loading")),1)):he.value.length===0?(o(),a("div",Dl,n(e.$t("readings.noReadings")),1)):(o(),a("div",Al,[(o(!0),a(h,null,k(he.value,s=>(o(),a("div",{key:s.id,class:"flex justify-between items-center p-3 bg-gray-700 rounded hover:bg-gray-600 cursor-pointer transition-colors",onClick:i=>Le(s.billId)},[t("div",null,[t("span",Fl,n(Re(s.meterValue))+" "+n(Pe(s.billId)),1),t("span",Nl,n(Be(s.recordedAt)),1),we(s.billId)?(o(),a("span",jl,n(we(s.billId))+" → ",1)):p("",!0)]),t("span",Vl,n(qe(s.subjectId,s.subjectType)),1)],8,Ul))),128))]))])],512),[[ye,x.value==="readings"]]),c(t("div",null,[t("div",Cl,[t("h2",Il,n(e.$t("bills.recurringBills")),1),de.value?(o(),a("div",Rl,n(e.$t("common.loading")),1)):X.value.length===0?(o(),a("div",Sl,[b(u(se),{class:"w-12 h-12 mx-auto mb-3 opacity-50"}),t("p",null,n(e.$t("bills.noRecurring")),1),t("p",Ml,n(e.$t("bills.createFirstRecurring")),1)])):(o(),a("div",Bl,[(o(!0),a(h,null,k(X.value,s=>(o(),a("div",{key:s.id,class:"p-4 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors"},[t("div",Pl,[t("div",ql,[t("div",Ll,[t("h3",El,n(s.customType),1),t("span",{class:j(["px-2 py-1 rounded text-xs",s.isActive?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"])},n(s.isActive?e.$t("bills.active"):e.$t("bills.inactive")),3),t("span",Ol,n(We(s.frequency)),1)]),t("div",Gl,[t("div",null,[t("span",Yl,n(e.$t("bills.recurringAmount")),1),t("span",zl,n(ee(s.amount))+" PLN",1)]),t("div",null,[t("span",Hl,n(e.$t("bills.dayOfMonth")),1),t("span",Wl,n(s.dayOfMonth),1)]),t("div",null,[t("span",Xl,n(e.$t("bills.nextDueDate")),1),t("span",Zl,n(U(s.nextDueDate)),1)]),s.lastGeneratedAt?(o(),a("div",Jl,[t("span",Kl,n(e.$t("bills.lastGenerated")),1),t("span",Ql,n(U(s.lastGeneratedAt)),1)])):p("",!0)]),s.allocations&&s.allocations.length>0?(o(),a("div",en,[t("span",tn,n(e.$t("bills.allocation")),1),t("div",sn,[(o(!0),a(h,null,k(s.allocations,(i,r)=>(o(),a("span",{key:r,class:"px-2 py-1 bg-gray-600 rounded text-xs"},n(Xe(i)),1))),128))])])):p("",!0),s.notes?(o(),a("div",ln,n(s.notes),1)):p("",!0)]),t("div",nn,[t("button",{onClick:i=>ze(s),class:"btn btn-sm btn-outline"},n(e.$t("common.edit")),9,on),u(C).hasPermission("bills.delete")?(o(),a("button",{key:0,onClick:i=>He(s.id),class:"btn btn-sm btn-outline text-red-400 hover:text-red-300"},[b(u(be),{class:"w-4 h-4"})],8,an)):p("",!0)])])]))),128))]))])],512),[[ye,x.value==="recurring"]]),Z.value?(o(),a("div",{key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",onClick:V(Q,["self"])},[t("div",rn,[t("div",un,[t("h2",dn,n(M.value?e.$t("common.edit"):e.$t("common.create"))+" "+n(e.$t("bills.recurringModalTitle")),1),t("button",{onClick:Q,class:"text-gray-400 hover:text-white"},[b(u(ve),{class:"w-6 h-6"})])]),t("form",{onSubmit:V(Ye,["prevent"]),class:"space-y-4"},[t("div",null,[t("label",cn,n(e.$t("bills.recurringName")),1),c(t("input",{"onUpdate:modelValue":l[29]||(l[29]=s=>m.value.customType=s),type:"text",required:"",class:"input",placeholder:e.$t("bills.recurringNameExample")},null,8,pn),[[f,m.value.customType]])]),t("div",mn,[t("div",null,[t("label",vn,n(e.$t("bills.amount")),1),c(t("input",{"onUpdate:modelValue":l[30]||(l[30]=s=>m.value.amount=s),type:"number",step:"0.01",required:"",class:"input",placeholder:"150.00"},null,512),[[f,m.value.amount,void 0,{number:!0}]])]),t("div",null,[t("label",yn,n(e.$t("bills.frequency")),1),c(t("select",{"onUpdate:modelValue":l[31]||(l[31]=s=>m.value.frequency=s),required:"",class:"input"},[t("option",bn,n(e.$t("bills.monthly")),1),t("option",fn,n(e.$t("bills.quarterly")),1),t("option",gn,n(e.$t("bills.yearly")),1)],512),[[w,m.value.frequency]])])]),t("div",hn,[t("div",null,[t("label",_n,n(e.$t("bills.dayOfMonthLabel")),1),c(t("input",{"onUpdate:modelValue":l[32]||(l[32]=s=>m.value.dayOfMonth=s),type:"number",min:"1",max:"31",required:"",class:"input",placeholder:"15"},null,512),[[f,m.value.dayOfMonth,void 0,{number:!0}]]),t("p",$n,n(e.$t("bills.dayOfMonthHint")),1)]),t("div",null,[t("label",kn,n(e.$t("bills.startDate")),1),c(t("input",{"onUpdate:modelValue":l[33]||(l[33]=s=>m.value.startDate=s),type:"date",class:"input",min:"2000-01-01",max:"2099-12-31",required:""},null,512),[[f,m.value.startDate]]),t("p",wn,n(e.$t("bills.startDateHint")),1)])]),t("div",null,[t("label",xn,n(e.$t("bills.costAllocation")),1),t("div",Tn,[(o(!0),a(h,null,k(m.value.allocations,(s,i)=>(o(),a("div",{key:i,class:"p-3 bg-gray-700 rounded-lg space-y-2"},[t("div",Dn,[c(t("select",{"onUpdate:modelValue":r=>s.subjectType=r,class:"input flex-1",onChange:r=>s.subjectId=""},[t("option",Un,n(e.$t("common.user")),1),t("option",Fn,n(e.$t("common.group")),1)],40,An),[[w,s.subjectType]]),c(t("select",{"onUpdate:modelValue":r=>s.subjectId=r,required:"",class:"input flex-1"},[t("option",jn,n(e.$t("common.select")),1),s.subjectType==="user"?(o(!0),a(h,{key:0},k(I.value,r=>(o(),a("option",{key:r.id,value:r.id},n(r.name||r.email),9,Vn))),128)):p("",!0),s.subjectType==="group"?(o(!0),a(h,{key:1},k(P.value,r=>(o(),a("option",{key:r.id,value:r.id},n(r.name),9,Cn))),128)):p("",!0)],8,Nn),[[w,s.subjectId]]),t("button",{type:"button",onClick:r=>Ge(i),class:"btn btn-sm btn-outline text-red-400"},[b(u(ve),{class:"w-4 h-4"})],8,In)]),t("div",Rn,[c(t("select",{"onUpdate:modelValue":r=>s.allocationType=r,class:"input w-32"},[t("option",Mn,n(e.$t("bills.percentage")),1),t("option",Bn,n(e.$t("bills.fraction")),1),t("option",Pn,n(e.$t("bills.fixedAmount")),1)],8,Sn),[[w,s.allocationType]]),s.allocationType==="percentage"?(o(),a("div",qn,[c(t("input",{"onUpdate:modelValue":r=>s.percentage=r,type:"number",step:"0.01",min:"0",max:"100",required:"",class:"input flex-1",placeholder:"50"},null,8,Ln),[[f,s.percentage,void 0,{number:!0}]]),l[36]||(l[36]=t("span",{class:"text-gray-400"},"%",-1))])):p("",!0),s.allocationType==="fraction"?(o(),a("div",En,[c(t("input",{"onUpdate:modelValue":r=>s.fractionNum=r,type:"number",min:"1",required:"",class:"input w-20",placeholder:"1"},null,8,On),[[f,s.fractionNum,void 0,{number:!0}]]),l[37]||(l[37]=t("span",{class:"text-gray-400"},"/",-1)),c(t("input",{"onUpdate:modelValue":r=>s.fractionDenom=r,type:"number",min:"1",required:"",class:"input w-20",placeholder:"3"},null,8,Gn),[[f,s.fractionDenom,void 0,{number:!0}]])])):p("",!0),s.allocationType==="fixed"?(o(),a("div",Yn,[c(t("input",{"onUpdate:modelValue":r=>s.fixedAmount=r,type:"number",step:"0.01",min:"0",required:"",class:"input flex-1",placeholder:"100.00"},null,8,zn),[[f,s.fixedAmount,void 0,{number:!0}]]),l[38]||(l[38]=t("span",{class:"text-gray-400"},"PLN",-1))])):p("",!0)])]))),128)),t("button",{type:"button",onClick:Oe,class:"btn btn-sm btn-outline w-full"},[b(u(te),{class:"w-4 h-4 mr-2"}),$(" "+n(e.$t("bills.addAllocation")),1)]),ce.value?p("",!0):(o(),a("p",Hn,n(ge.value),1))])]),t("div",null,[t("label",Wn,n(e.$t("bills.recurringNotes")),1),c(t("textarea",{"onUpdate:modelValue":l[34]||(l[34]=s=>m.value.notes=s),class:"input",rows:"2",placeholder:e.$t("bills.notesPlaceholder")},null,8,Xn),[[f,m.value.notes]])]),B.value?(o(),a("div",Zn,[b(u(Te),{class:"w-4 h-4"}),$(" "+n(B.value),1)])):p("",!0),t("div",Jn,[t("button",{type:"button",onClick:Q,class:"btn btn-outline"},n(e.$t("common.cancel")),1),t("button",{type:"submit",disabled:O.value||!ce.value,class:"btn btn-primary"},n(O.value?e.$t("common.saving"):M.value?e.$t("bills.saveChanges"):e.$t("common.create")),9,Kn)])],32)])])):p("",!0)]))}};export{ao as default};
