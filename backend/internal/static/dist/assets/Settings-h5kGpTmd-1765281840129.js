import{c as J,i as As,j as Ps,k as Ds,r as i,o as Ss,A as y,b as n,e,g as c,t as o,p as x,q as m,y as k,u as d,f as p,v as $,F as f,h as g,X as O,E as S,J as _t,U as jt,M as Ut,n as Z,m as Ts,D as Es,d as l,s as Rs,w as Ls}from"./index-Hs7aDjjl-1765281840129.js";import{a as Fs,u as Is}from"./useLocale-BGSA8Lij-1765281840129.js";import{u as Ms,D as T}from"./useDataEvents-DV5fgDvx-1765281840129.js";import{K as Nt}from"./key-D2n3iSJi-1765281840129.js";import{U as Ct}from"./users-4UTmRSxS-1765281840129.js";import{T as de,S as at}from"./trash-hN3idhIk-1765281840129.js";/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=J("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=J("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=J("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=J("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=J("shield-off",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=J("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=J("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),Bs={class:"text-3xl font-bold mb-8"},Gs={class:"card"},Ws={class:"text-xl font-semibold mb-4"},Ks={class:"block text-sm font-medium mb-2"},Hs={class:"block text-sm font-medium mb-2"},Js=["value"],Ys={key:0,class:"text-red-500 text-sm"},Qs={key:1,class:"text-green-500 text-sm"},Xs=["disabled"],ea={class:"card mt-6"},ta={class:"text-xl font-semibold mb-4"},sa={class:"block text-sm font-medium mb-2"},aa={class:"block text-sm font-medium mb-2"},oa={key:0,class:"text-red-500 text-sm"},la={key:1,class:"text-green-500 text-sm"},na=["disabled"],ia={class:"card mt-6"},ra={class:"flex justify-between items-center mb-4"},ua={key:0,class:"text-center py-8 text-gray-400"},da={key:1,class:"text-center py-8"},ca={key:2,class:"text-center py-8 text-gray-400"},pa={key:3,class:"space-y-3"},ma={class:"flex items-center gap-3"},ya={class:"w-10 h-10 rounded-lg bg-purple-600/20 flex items-center justify-center"},va={class:"font-medium"},wa={class:"text-xs text-gray-400"},ba={class:"text-xs text-gray-400"},ka=["onClick"],fa={key:4,class:"mt-4 text-red-500 text-sm"},ga={key:5,class:"mt-4 text-green-500 text-sm"},xa={class:"card max-w-lg w-full mx-4"},ha={class:"flex justify-between items-center mb-6"},za={key:0,class:"text-red-500 text-sm"},_a={class:"flex gap-3"},ja=["disabled"],Ua={class:"card mt-6"},Na={class:"text-xl font-semibold mb-4"},Ca={key:0,class:"text-center py-8"},$a={key:1,class:"text-center py-8 text-gray-400"},Aa={key:2,class:"space-y-3"},Pa={class:"flex items-start justify-between gap-4"},Da={class:"flex-1"},Sa={class:"flex items-center gap-2 mb-2"},Ta={class:"font-semibold"},Ea={key:0,class:"text-xs px-2 py-0.5 rounded-full bg-purple-600 text-white"},Ra={class:"text-sm text-gray-400 space-y-1"},La={key:0},Fa={class:"flex gap-2"},Ia=["onClick","title"],Ma=["onClick","title"],Va={key:0,class:"pt-4 border-t border-gray-700"},Oa=["disabled"],Za={class:"card max-w-md w-full mx-4"},qa={class:"flex justify-between items-center mb-6"},Ba={class:"text-xl font-bold"},Ga={class:"block text-sm font-medium mb-2"},Wa={class:"flex gap-3"},Ka=["disabled"],Ha={class:"card mt-6"},Ja={class:"mb-4"},Ya={class:"flex items-center gap-2"},Qa={class:"text-xl font-semibold"},Xa={class:"text-sm text-gray-400 mt-1"},eo={class:"flex flex-wrap gap-3"},to=["onClick"],so={class:"text-xl"},ao={class:"font-medium"},oo={key:0,class:"w-4 h-4 text-purple-400",fill:"currentColor",viewBox:"0 0 20 20"},lo={key:2,class:"mt-8 space-y-6"},no={class:"card"},io={class:"mb-4"},ro={class:"text-xl font-semibold mb-1"},uo={class:"text-sm text-gray-400"},co={class:"block text-sm font-medium mb-2"},po={class:"text-xs text-gray-400 mt-1"},mo={class:"pt-4 border-t border-gray-700"},yo={class:"text-lg font-medium mb-3"},vo={class:"space-y-4"},wo={class:"block text-sm font-medium mb-2"},bo=["value"],ko={class:"text-xs text-gray-400 mt-1"},fo={class:"flex items-center gap-3 cursor-pointer"},go={class:"font-medium"},xo={class:"text-xs text-gray-400"},ho={key:0,class:"text-red-500 text-sm"},zo={key:1,class:"text-green-500 text-sm"},_o=["disabled"],jo={class:"card"},Uo={class:"flex justify-between items-center mb-4"},No={key:0,class:"text-center py-8"},Co={key:1,class:"text-center py-8 text-gray-400"},$o={key:2,class:"overflow-x-auto -mx-4 sm:mx-0"},Ao={class:"w-full min-w-max"},Po={class:"py-3 px-2 sm:px-0"},Do={class:"text-xs text-gray-400 md:hidden"},So={class:"py-3 px-2 sm:px-0 hidden md:table-cell"},To={class:"py-3 px-2 sm:px-0"},Eo={class:"py-3 px-2 sm:px-0 hidden lg:table-cell"},Ro={class:"py-3 px-2 sm:px-0 hidden sm:table-cell"},Lo={class:"py-3 px-2 sm:px-0"},Fo={class:"flex flex-col sm:flex-row flex-wrap gap-1 sm:gap-2"},Io=["onClick"],Mo=["onClick","disabled"],Vo=["onClick","disabled"],Oo=["onClick","disabled"],Zo=["onClick","disabled"],qo=["onClick","disabled"],Bo={class:"card"},Go={class:"flex justify-between items-center mb-4"},Wo={key:0,class:"text-center py-8"},Ko={key:1,class:"text-center py-8 text-gray-400"},Ho={key:2,class:"space-y-3"},Jo={class:"flex flex-col sm:flex-row justify-between items-start gap-3 mb-3"},Yo={class:"flex-1"},Qo={class:"font-medium"},Xo={class:"text-sm text-gray-400"},el={class:"flex flex-wrap gap-2 w-full sm:w-auto"},tl=["onClick"],sl=["onClick"],al=["onClick"],ol={key:0,class:"mt-2"},ll={class:"flex flex-wrap gap-1"},nl={class:"card"},il={class:"flex justify-between items-center mb-4"},rl=["disabled"],ul={class:"space-y-3 mb-4"},dl={class:"relative"},cl={class:"grid grid-cols-1 md:grid-cols-4 gap-3"},pl=["value"],ml={class:"grid grid-cols-1 md:grid-cols-3 gap-3"},yl={key:0,class:"text-center py-8"},vl={key:1,class:"text-center py-8 text-gray-400"},wl={key:2,class:"space-y-2 max-h-[600px] overflow-y-auto"},bl=["onClick"],kl={class:"flex items-start justify-between"},fl={class:"flex-1"},gl={class:"flex items-center gap-2 mb-1"},xl={class:"font-medium"},hl={key:0,class:"text-sm text-gray-300 mb-2"},zl={class:"text-xs text-gray-500 flex flex-wrap gap-x-3 gap-y-1"},_l={key:0},jl={key:1,class:"mt-3 pt-3 border-t border-gray-600"},Ul={class:"text-sm space-y-2"},Nl={class:"text-gray-400 font-medium mb-1"},Cl={class:"text-gray-300 pl-3 break-words",style:{"white-space":"pre-wrap"}},$l={class:"mt-3 text-sm text-gray-400 text-center"},Al={class:"card"},Pl={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-4"},Dl={key:0,class:"text-center py-8"},Sl={key:1,class:"space-y-3"},Tl={class:"flex flex-col sm:flex-row justify-between items-start gap-3 mb-3"},El={class:"flex-1"},Rl={class:"flex items-center gap-2 flex-wrap"},Ll={class:"font-semibold"},Fl={key:0,class:"text-xs px-2 py-0.5 bg-purple-600/20 text-purple-400 rounded whitespace-nowrap"},Il={class:"text-sm text-gray-400 mt-1"},Ml={class:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto"},Vl=["onClick"],Ol=["onClick"],Zl={key:2,class:"text-xs sm:text-sm text-gray-500 italic text-center sm:text-left"},ql={class:"flex flex-wrap gap-2"},Bl={key:0,class:"text-xs px-2 py-1 text-gray-400 whitespace-nowrap"},Gl={class:"card"},Wl={class:"flex justify-between items-center mb-4"},Kl=["disabled"],Hl={key:0,class:"text-center py-8"},Jl={key:1,class:"text-center py-8 text-gray-400"},Yl={key:2,class:"space-y-3"},Ql={class:"flex justify-between items-start"},Xl={class:"flex-1"},en={class:"flex items-center gap-2 mb-2"},tn={class:"font-semibold"},sn={class:"text-sm font-mono text-gray-400"},an={class:"text-sm text-gray-400"},on={class:"flex gap-2"},ln=["onClick"],nn=["onClick"],rn={class:"card"},un={class:"space-y-3"},dn={class:"border border-gray-700 rounded-xl overflow-hidden"},cn={class:"flex items-center gap-3"},pn={class:"w-10 h-10 rounded-lg bg-green-600/20 flex items-center justify-center flex-shrink-0"},mn={key:0,class:"p-4 border-t border-gray-700"},yn=["disabled"],vn={class:"border border-red-600/30 rounded-xl overflow-hidden"},wn={class:"flex items-center gap-3"},bn={class:"w-10 h-10 rounded-lg bg-red-600/20 flex items-center justify-center flex-shrink-0"},kn={key:0,class:"p-4 border-t border-red-600/30 bg-red-600/5"},fn={class:"space-y-2"},gn=["disabled"],xn={key:0,class:"text-sm text-gray-400"},hn={key:0,class:"p-4 bg-red-600/20 rounded-xl border border-red-600/50"},zn={class:"text-red-400 text-sm"},_n={key:1,class:"p-4 bg-green-600/20 rounded-xl border border-green-600/50"},jn={class:"text-green-400 text-sm"},Un={class:"card max-w-lg w-full mx-4"},Nn={class:"flex justify-between items-center mb-6"},Cn={key:0},$n={class:"block text-sm font-medium mb-2"},An={key:0,class:"text-gray-400 text-xs ml-1"},Pn=["required"],Dn=["value"],Sn={key:1,class:"text-red-500 text-sm"},Tn={class:"flex gap-3"},En=["disabled"],Rn={class:"card max-w-lg w-full mx-4"},Ln={class:"flex justify-between items-center mb-6"},Fn={key:0,class:"space-y-4"},In={class:"text-sm text-gray-400"},Mn={key:0,class:"text-red-500 text-sm"},Vn={class:"flex gap-3"},On=["disabled"],Zn={key:1,class:"space-y-4"},qn={class:"flex gap-2"},Bn=["value"],Gn={class:"text-xs text-gray-400"},Wn={class:"card max-w-lg w-full mx-4"},Kn={class:"flex justify-between items-center mb-6"},Hn={class:"text-2xl font-bold"},Jn={key:0,class:"text-red-500 text-sm"},Yn={class:"flex gap-3"},Qn=["disabled"],Xn={class:"card max-w-lg w-full mx-4"},ei={class:"flex justify-between items-center mb-6"},ti=["value"],si={key:0,class:"text-red-500 text-sm"},ai={class:"flex gap-3"},oi=["disabled"],li={class:"card max-w-lg w-full mx-4"},ni={class:"flex justify-between items-center mb-6"},ii={class:"text-2xl font-bold"},ri={class:"space-y-4"},ui=["value"],di=["disabled"],ci={key:0},pi={class:"space-y-2"},mi={class:"font-medium"},yi={class:"text-sm text-gray-400"},vi=["onClick"],wi={key:1,class:"text-center py-4 text-gray-400"},bi={key:2,class:"text-red-500 text-sm"},ki={class:"bg-gray-800 rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto"},fi={class:"flex justify-between items-center mb-4"},gi={class:"text-xl font-semibold"},xi=["disabled"],hi={class:"space-y-4 max-h-[300px] overflow-y-auto"},zi={class:"text-sm font-semibold mb-2 capitalize"},_i={class:"space-y-2"},ji=["value"],Ui={class:"text-sm"},Ni={class:"flex gap-3"},Ci={type:"submit",class:"btn btn-primary flex-1"},Li={__name:"Settings",setup($i){const kt=Ts(),{t:Ai}=As(),w=Ps(),xe=Ds(),{checkSupport:Dt,listPasskeys:St,register:Tt,deletePasskey:Et}=Fs(),{emit:A}=Ms(),{locale:ft,locales:gt,changeLocale:Rt}=Is(),E=i({name:w.user?.name||"",email:w.user?.email||""}),L=i({currentPassword:"",newPassword:""}),ot=i(!1),he=i(""),ze=i(""),_e=i(!1),je=i(""),Ue=i(""),q=i([]),Ne=i([]),lt=i(!1),nt=i(!1),Ce=i(!1),$e=i(!1),B=i(null),ce=i(null),Y=i(""),Q=i(""),Ae=i(!1),Pe=i(!1),F=i({appName:""}),De=i(!1),Se=i(""),Te=i(""),X=i(!1),ee=i(!1),Ee=i(!1),Re=i(!1),it=i(!1),pe=i(null),G=i(60),Le=i(!1),te=i(""),se=i(""),me=i(!1),rt=i(null),h=i({name:"",email:"",username:"",password:"",role:"RESIDENT"}),j=i({id:"",name:"",email:"",role:""}),P=i({name:"",weight:1}),ae=i(null),I=i(null),W=i(""),Fe=i(!1),Ie=i(!1),Me=i(!1),Ve=i(!1),M=i(""),ye=i(""),K=i(""),Oe=i(!1),ve=i([]),ut=i(!1),Ze=i(!1),oe=i(!1),qe=i(""),U=i(""),le=i(""),ne=i([]),dt=i(!1),ie=i(!1),Be=i(!1),Ge=i(!1),we=i({id:"",name:""}),We=i([]),Ke=i(!1),be=i(new Set),v=i({userEmail:"",action:"",status:"",search:"",dateFrom:"",dateTo:"",resourceType:""}),ct=i(50),ke=i([]),pt=i(!1),xt=i({}),re=i(!1),D=i(!1),_=i({id:"",name:"",displayName:"",permissions:[]}),mt=i([]),He=i(!1);Ss(async()=>{E.value={name:w.user?.name||"",email:w.user?.email||""},await w.fetchAuthConfig(),w.isAdmin?(await Promise.all([R(),Je(),tt(),hs(),st(),N()]),F.value={appName:xe.appName,defaultLanguage:xe.defaultLanguage,disableAutoDetect:xe.disableAutoDetect}):await Je();const s=await Dt();Oe.value=s.supported,Oe.value&&await yt(),await vt()});async function Lt(){_e.value=!0,je.value="",Ue.value="";try{const s=await y.patch(`/users/${w.user.id}`,{name:E.value.name,email:E.value.email});w.user.name=E.value.name,w.user.email=E.value.email,A(T.USER_UPDATED,{userId:w.user.id}),Ue.value="Profil zaktualizowany pomyślnie"}catch(s){je.value=s.response?.data?.error||"Błąd aktualizacji profilu"}finally{_e.value=!1}}async function Ft(){De.value=!0,Se.value="",Te.value="";try{await xe.updateSettings(F.value),Te.value="Ustawienia zapisane"}catch(s){Se.value=s.response?.data?.error||"Nie udało się zapisać ustawień"}finally{De.value=!1}}async function It(){ot.value=!0,he.value="",ze.value="";try{await y.post("/users/change-password",{oldPassword:L.value.currentPassword,newPassword:L.value.newPassword}),ze.value="Hasło zostało zmienione",L.value.currentPassword="",L.value.newPassword=""}catch(s){he.value=s.response?.data?.error||"Błąd zmiany hasła"}finally{ot.value=!1}}async function R(){lt.value=!0;try{const s=await y.get("/users");q.value=s.data||[]}catch(s){console.error("Failed to load users:",s),q.value=[]}finally{lt.value=!1}}async function Je(){nt.value=!0;try{const s=await y.get("/groups");Ne.value=s.data||[]}catch(s){console.error("Failed to load groups:",s),Ne.value=[]}finally{nt.value=!1}}async function Mt(){Ie.value=!0,M.value="";try{const s={name:h.value.name,email:h.value.email,tempPassword:h.value.password,role:h.value.role};h.value.username?.trim()&&(s.username=h.value.username.trim()),await y.post("/users",s),X.value=!1,h.value={name:"",email:"",username:"",password:"",role:"RESIDENT"},await R(),A(T.USER_CREATED)}catch(s){M.value=s.response?.data?.error||"Nie udało się utworzyć użytkownika"}finally{Ie.value=!1}}function Vt(s){j.value={id:s.id,name:s.name,email:s.email,role:s.role},ee.value=!0}async function Ot(){Me.value=!0,M.value="";try{await y.patch(`/users/${j.value.id}`,{name:j.value.name,email:j.value.email,role:j.value.role}),ee.value=!1,await R(),A(T.USER_UPDATED,{userId:j.value.id})}catch(s){M.value=s.response?.data?.error||"Nie udało się zaktualizować użytkownika"}finally{Me.value=!1}}async function Zt(s){try{await y.patch(`/users/${s.id}`,{isActive:!s.isActive}),await R(),A(T.USER_UPDATED,{userId:s.id})}catch(t){console.error("Failed to toggle user status:",t),alert("Nie udało się zmienić statusu użytkownika: "+(t.response?.data?.error||t.message))}}async function qt(s){if(confirm(`Czy na pewno chcesz wymusić zmianę hasła dla użytkownika ${s.name}?

Użytkownik będzie musiał zmienić hasło przy następnym logowaniu TYLKO przy użyciu hasła (nie passkey).`))try{await y.post(`/users/${s.id}/force-password-change`),await R(),alert("Wymuszono zmianę hasła dla użytkownika")}catch(t){console.error("Failed to force password change:",t),alert("Nie udało się wymusić zmiany hasła: "+(t.response?.data?.error||t.message))}}async function Bt(s){if(s.isActive){alert("Nie można usunąć aktywnego użytkownika. Najpierw dezaktywuj użytkownika.");return}if(confirm(`Czy na pewno chcesz USUNĄĆ użytkownika ${s.name}?

Tej operacji NIE MOŻNA cofnąć!

Wszystkie dane użytkownika (historia, rachunki, obowiązki) zostaną zachowane, ale użytkownik nie będzie mógł się zalogować.`))try{await y.delete(`/users/${s.id}`),await R(),A(T.USER_DELETED,{userId:s.id}),alert("Użytkownik został usunięty")}catch(t){console.error("Failed to delete user:",t),alert("Nie udało się usunąć użytkownika: "+(t.response?.data?.error||t.message))}}function Gt(s){kt.push(`/dashboard/${s}`)}function Wt(s){pe.value=s,G.value=60,te.value="",se.value="",me.value=!1,it.value=!0}function Ye(){it.value=!1,pe.value=null,te.value="",se.value="",me.value=!1}async function Kt(){if(pe.value){Le.value=!0,se.value="";try{const s=await y.post(`/users/${pe.value.id}/generate-reset-link`,{expirationMinutes:G.value});te.value=s.data.resetURL}catch(s){console.error("Failed to generate reset link:",s),se.value=s.response?.data?.error||s.message||"Nie udało się wygenerować linku"}finally{Le.value=!1}}}async function Ht(){try{await navigator.clipboard.writeText(te.value),me.value=!0,setTimeout(()=>{me.value=!1},2e3)}catch(s){console.error("Failed to copy to clipboard:",s),rt.value&&rt.value.select()}}function Jt(s){ae.value=s,P.value={name:s.name,weight:parseFloat(s.weight.$numberDecimal||s.weight||1)},Ee.value=!0}async function Yt(){Ve.value=!0,ye.value="";try{ae.value?(await y.patch(`/groups/${ae.value.id}`,{name:P.value.name,weight:P.value.weight}),A(T.GROUP_UPDATED,{groupId:ae.value.id})):(await y.post("/groups",{name:P.value.name,weight:P.value.weight}),A(T.GROUP_CREATED)),Qe(),await Je()}catch(s){ye.value=s.response?.data?.error||"Nie udało się zapisać grupy"}finally{Ve.value=!1}}async function Qt(s){if(confirm(`Czy na pewno chcesz usunąć tę grupę?

UWAGA: Nie można usunąć grupy, która ma przypisanych użytkowników.
Najpierw usuń wszystkich użytkowników z tej grupy.`))try{await y.delete(`/groups/${s}`),await Je(),await R(),A(T.GROUP_DELETED,{groupId:s}),alert("Grupa została usunięta pomyślnie")}catch(t){console.error("Failed to delete group:",t),console.error("Error response:",t.response),console.error("Error data:",t.response?.data);const r=t.response?.data?.error||t.message;console.error("Parsed error message:",r),r&&r.includes("users are still assigned")?alert(`Nie można usunąć grupy: Grupa ma przypisanych użytkowników.

Najpierw usuń wszystkich użytkowników z tej grupy (zmień ich grupę na "Brak grupy" w edycji użytkownika).`):alert("Nie udało się usunąć grupy: "+r)}}function Qe(){Ee.value=!1,ae.value=null,P.value={name:"",weight:1},ye.value=""}function Xt(s){I.value=s,W.value="",K.value="",Re.value=!0}function Xe(s){return s?q.value.filter(t=>t.groupId===s):[]}function es(){return I.value?q.value.filter(s=>s.groupId!==I.value.id):[]}async function ts(){if(!(!W.value||!I.value)){Fe.value=!0,K.value="";try{const s=W.value;await y.patch(`/users/${s}`,{groupId:I.value.id}),await R(),W.value="",A(T.USER_UPDATED,{userId:s})}catch(s){K.value=s.response?.data?.error||"Nie udało się dodać użytkownika do grupy"}finally{Fe.value=!1}}}async function ss(s){if(confirm("Czy na pewno chcesz usunąć tego użytkownika z grupy?")){K.value="";try{await y.patch(`/users/${s}`,{groupId:"000000000000000000000000"}),await R(),A(T.USER_UPDATED,{userId:s})}catch(t){K.value=t.response?.data?.error||"Nie udało się usunąć użytkownika z grupy"}}}async function yt(){ut.value=!0,U.value="";try{const s=await St();ve.value=s||[]}catch(s){console.error("Failed to load passkeys:",s),U.value="Nie udało się załadować passkeys",ve.value=[]}finally{ut.value=!1}}async function as(){Ze.value=!0,U.value="",le.value="";try{const s=qe.value.trim()||`Passkey ${new Date().toLocaleDateString("pl-PL")}`;await Tt(s),le.value="Passkey dodany pomyślnie",oe.value=!1,qe.value="",await yt()}catch(s){console.error("Failed to add passkey:",s),U.value=s.message||"Nie udało się dodać passkey"}finally{Ze.value=!1}}async function os(s){if(confirm("Czy na pewno chcesz usunąć ten passkey?")){U.value="",le.value="";try{const t=ve.value[s];if(!t.credentialId){U.value="Brak ID passkey";return}await Et(t.credentialId),le.value="Passkey usunięty pomyślnie",await yt()}catch(t){console.error("Failed to delete passkey:",t),U.value=t.message||"Nie udało się usunąć passkey"}}}async function ls(){Ce.value=!0,Y.value="",Q.value="";try{const s=await y.get("/backup/export",{responseType:"blob"}),t=window.URL.createObjectURL(new Blob([s.data])),r=document.createElement("a");r.href=t,r.setAttribute("download",`holy-home-backup-${new Date().toISOString().split("T")[0]}.json`),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(t),Q.value="Kopia zapasowa została pobrana pomyślnie"}catch(s){console.error("Failed to export backup:",s),Y.value=s.response?.data?.error||"Nie udało się wyeksportować kopii zapasowej"}finally{Ce.value=!1}}function ns(s){const t=s.target.files[0];if(!t){B.value=null;return}B.value=t,confirm(`OSTRZEŻENIE: Czy na pewno chcesz zaimportować kopię zapasową?

Operacja:
- Usunie WSZYSTKIE obecne dane
- Zastąpi je danymi z pliku: ${t.name}
- Tej operacji NIE MOŻNA cofnąć

Kliknij OK, aby kontynuować lub Anuluj, aby przerwać.`)?is(t):(B.value=null,s.target.value="")}async function is(s){$e.value=!0,Y.value="",Q.value="";try{const t=await y.post("/backup/import",s,{headers:{"Content-Type":"application/json"}});Q.value="Kopia zapasowa została zaimportowana pomyślnie. Odśwież stronę, aby zobaczyć zmiany.",B.value=null,ce.value&&(ce.value.value=""),setTimeout(()=>{window.location.reload()},3e3)}catch(t){console.error("Failed to import backup:",t),Y.value=t.response?.data?.error||"Nie udało się zaimportować kopii zapasowej",B.value=null,ce.value&&(ce.value.value="")}finally{$e.value=!1}}async function vt(){dt.value=!0;try{const s=await y.get("/sessions");ne.value=s.data||[]}catch(s){console.error("Failed to load sessions:",s)}finally{dt.value=!1}}function rs(s){if(ne.value.length===0)return!1;const t=ne.value.reduce((r,a)=>new Date(a.lastUsedAt)>new Date(r.lastUsedAt)?a:r);return s.id===t.id}function us(s){we.value={id:s.id,name:s.name},ie.value=!0}async function ds(){Be.value=!0;try{await y.patch(`/sessions/${we.value.id}`,{name:we.value.name}),ie.value=!1,await vt()}catch(s){console.error("Failed to rename session:",s),alert("Nie udało się zmienić nazwy sesji")}finally{Be.value=!1}}async function cs(s){if(confirm("Czy na pewno chcesz usunąć tę sesję? Zostaniesz wylogowany z tego urządzenia."))try{await y.delete(`/sessions/${s}`),await vt()}catch(t){console.error("Failed to delete session:",t),alert("Nie udało się usunąć sesji")}}async function ps(){if(confirm("Czy na pewno chcesz wylogować się ze wszystkich urządzeń? Zostaniesz wylogowany również z tego urządzenia.")){Ge.value=!0;try{await y.delete("/sessions"),w.logout(),kt.push("/login")}catch(s){console.error("Failed to revoke all sessions:",s),alert("Nie udało się wylogować ze wszystkich urządzeń")}finally{Ge.value=!1}}}function et(s){return s?new Date(s).toLocaleString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-"}function ms(s){return{users:"Użytkownicy",groups:"Grupy",bills:"Rachunki",chores:"Obowiązki",supplies:"Zaopatrzenie",roles:"Role",approvals:"Zatwierdzenia",audit:"Audyt",loans:"Pożyczki",backup:"Kopia zapasowa"}[s]||s}function ys(s){return{"Create new users":"Twórz nowych użytkowników","View user information":"Przeglądaj informacje o użytkownikach","Update user information":"Aktualizuj informacje o użytkownikach","Delete users":"Usuń użytkowników","Create new groups":"Twórz nowe grupy","View groups":"Przeglądaj grupy","Update groups":"Aktualizuj grupy","Delete groups":"Usuń grupy","Create new bills":"Twórz nowe rachunki","View bills":"Przeglądaj rachunki","Update bills":"Aktualizuj rachunki","Delete bills":"Usuń rachunki","Post bills (freeze allocations)":"Opublikuj rachunki","Close bills":"Zamknij rachunki","Create new chores":"Twórz nowe obowiązki","View chores":"Przeglądaj obowiązki","Update chores":"Aktualizuj obowiązki","Delete chores":"Usuń obowiązki","Assign chores to users":"Przypisz obowiązki do użytkowników","Add supply items":"Dodaj artykuły zaopatrzeniowe","View supplies":"Przeglądaj zaopatrzenie","Update supply items":"Aktualizuj artykuły zaopatrzeniowe","Delete supply items":"Usuń artykuły zaopatrzeniowe","Create custom roles":"Twórz niestandardowe role","View roles":"Przeglądaj role","Update roles":"Aktualizuj role","Delete roles":"Usuń role","Review and approve/reject pending actions":"Przeglądaj i zatwierdź/odrzuć oczekujące akcje","View audit logs":"Przeglądaj logi audytu"}[s]||s}function ue(s){return{"users.create":"Twórz użytkowników","users.read":"Czytaj użytkowników","users.update":"Edytuj użytkowników","users.delete":"Usuń użytkowników","groups.create":"Twórz grupy","groups.read":"Czytaj grupy","groups.update":"Edytuj grupy","groups.delete":"Usuń grupy","bills.create":"Twórz rachunki","bills.read":"Czytaj rachunki","bills.update":"Edytuj rachunki","bills.delete":"Usuń rachunki","bills.post":"Opublikuj rachunki","bills.close":"Zamknij rachunki","chores.create":"Twórz obowiązki","chores.read":"Czytaj obowiązki","chores.update":"Edytuj obowiązki","chores.delete":"Usuń obowiązki","chores.assign":"Przypisz obowiązki","supplies.create":"Twórz zaopatrzenie","supplies.read":"Czytaj zaopatrzenie","supplies.update":"Edytuj zaopatrzenie","supplies.delete":"Usuń zaopatrzenie","roles.create":"Twórz role","roles.read":"Czytaj role","roles.update":"Edytuj role","roles.delete":"Usuń role","approvals.review":"Sprawdzaj zatwierdzenia","audit.read":"Czytaj logi audytu","loans.create":"Twórz pożyczki","loans.read":"Przeglądaj pożyczki","loans.update":"Edytuj pożyczki","loans.delete":"Usuń pożyczki","loan-payments.create":"Dodaj spłaty pożyczek","loan-payments.read":"Przeglądaj spłaty pożyczek","loan-payments.update":"Edytuj spłaty pożyczek","loan-payments.delete":"Usuń spłaty pożyczek","backup.export":"Eksportuj kopię zapasową","backup.import":"Importuj kopię zapasową"}[s]||s}function vs(s){return{"role.create":"Tworzenie roli","role.update":"Aktualizacja roli","role.delete":"Usunięcie roli","user.create":"Tworzenie użytkownika","user.update":"Aktualizacja użytkownika","user.delete":"Usunięcie użytkownika",create_bill:"Tworzenie rachunku","bill.create":"Tworzenie rachunku","bill.update":"Aktualizacja rachunku","bill.delete":"Usunięcie rachunku",post_bill:"Opublikowanie rachunku",close_bill:"Zamknięcie rachunku",create_reading:"Dodanie odczytu","reading.create":"Dodanie odczytu","chore.create":"Tworzenie obowiązku","chore.update":"Aktualizacja obowiązku","chore.delete":"Usunięcie obowiązku","supply.create":"Tworzenie zaopatrzenia","supply.update":"Aktualizacja zaopatrzenia","supply.delete":"Usunięcie zaopatrzenia","group.create":"Tworzenie grupy","group.update":"Aktualizacja grupy","group.delete":"Usunięcie grupy","loan.create":"Tworzenie pożyczki","loan.update":"Aktualizacja pożyczki","loan.delete":"Usunięcie pożyczki",create_loan:"Tworzenie pożyczki",create_loan_payment:"Dodanie spłaty pożyczki",delete_loan:"Usunięcie pożyczki"}[s]||s}let wt=null;function ws(){wt&&clearTimeout(wt),wt=setTimeout(()=>{N()},400)}async function N(){Ke.value=!0;try{const s=new URLSearchParams({limit:ct.value.toString()});v.value.userEmail&&s.append("userEmail",v.value.userEmail),v.value.action&&s.append("action",v.value.action),v.value.status&&s.append("status",v.value.status),v.value.search&&s.append("search",v.value.search),v.value.dateFrom&&s.append("dateFrom",v.value.dateFrom),v.value.dateTo&&s.append("dateTo",v.value.dateTo),v.value.resourceType&&s.append("resourceType",v.value.resourceType);const t=await y.get(`/audit/logs?${s.toString()}`);We.value=t.data.logs||[]}catch(s){console.error("Failed to load audit logs:",s)}finally{Ke.value=!1}}function bs(){v.value={userEmail:"",action:"",status:"",search:"",dateFrom:"",dateTo:"",resourceType:""},N()}function ks(s){be.value.has(s)?be.value.delete(s):be.value.add(s)}function fs(s){if(!s.details)return{};const t=s.details,r={};if(t.oldPermissions&&t.newPermissions){const a=new Set(t.oldPermissions),u=new Set(t.newPermissions),b=[...u].filter(z=>!a.has(z)),C=[...a].filter(z=>!u.has(z)),V=[...a].filter(z=>u.has(z));b.length>0&&(r["Dodane uprawnienia"]=b.map(z=>"• "+ue(z)).join(`
`)),C.length>0&&(r["Usunięte uprawnienia"]=C.map(z=>"• "+ue(z)).join(`
`)),V.length>0&&(r["Niezmienione uprawnienia"]=`${V.length} uprawnień`);const ge=["oldPermissions","newPermissions"];for(const[z,$s]of Object.entries(t))ge.includes(z)||(r[H(z)]=$s)}else if(t.changes&&typeof t.changes=="object"){r["Zmienione pola"]=Object.entries(t.changes).map(([a,u])=>`${H(a)}: ${u}`).join(`
`);for(const[a,u]of Object.entries(t))a!=="changes"&&(Array.isArray(u)?r[H(a)]=u.join(", "):typeof u=="object"&&u!==null?r[H(a)]=JSON.stringify(u,null,2):r[H(a)]=u)}else for(const[a,u]of Object.entries(t)){const b=H(a);Array.isArray(u)?a.includes("ermission")||a.includes("Permissions")?r[b]=u.map(C=>"• "+ue(C)).join(`
`):r[b]=u.join(", "):typeof u=="object"&&u!==null?r[b]=JSON.stringify(u,null,2):r[b]=u}return r}function bt(s){return!s.resourceId||s.status!=="success"?null:{bill:"/bills",chore:"/chores",user:"/settings",role:"/settings",group:"/settings"}[s.resourceType]||null}function gs(s){const t=vs(s.action);let r="";return s.details&&(s.details.targetUser?r=s.details.targetUser:s.details.userName?r=s.details.userName:s.details.userEmail?r=s.details.userEmail:s.details.roleName?r=s.details.roleName:s.details.newDisplayName?r=s.details.newDisplayName:s.details.displayName?r=s.details.displayName:s.details.bill_type?r=fe(s.details.bill_type):s.details.billType?r=fe(s.details.billType):s.details.type?r=fe(s.details.type):s.details.choreName?r=s.details.choreName:s.details.name&&s.resourceType==="chore"?r=s.details.name:s.details.groupName?r=s.details.groupName:s.details.name&&s.resourceType==="group"&&(r=s.details.name)),r?`${t}: ${r}`:t}function fe(s){return{electricity:"Prąd",gas:"Gaz",internet:"Internet",water:"Woda",inne:"Inne"}[s]||s}function ht(s){if(!s.details)return"";const t=s.details,r=[];if(t.oldPermissions&&t.newPermissions){const a=new Set(t.oldPermissions),u=new Set(t.newPermissions),b=[...u].filter(V=>!a.has(V)),C=[...a].filter(V=>!u.has(V));if(b.length>0){const ge=b.slice(0,2).map(z=>ue(z)).join(", ");r.push(`Dodano: ${ge}${b.length>2?` i ${b.length-2} więcej`:""}`)}if(C.length>0){const ge=C.slice(0,2).map(z=>ue(z)).join(", ");r.push(`Usunięto: ${ge}${C.length>2?` i ${C.length-2} więcej`:""}`)}}if(t.oldDisplayName&&t.newDisplayName&&t.oldDisplayName!==t.newDisplayName&&r.push(`Nazwa: ${t.oldDisplayName} → ${t.newDisplayName}`),t.oldRole&&t.newRole?r.push(`Rola: ${t.oldRole} → ${t.newRole}`):t.newRole&&r.push(`Nowa rola: ${t.newRole}`),t.targetUser&&!t.newRole&&!t.oldRole&&r.push(`Użytkownik: ${t.targetUser}`),t.changes&&typeof t.changes=="object")for(const[a,u]of Object.entries(t.changes))a==="name"?r.push(`Nazwa: ${u}`):a==="weight"?r.push(`Waga: ${u}`):a==="category"?r.push(`Kategoria: ${u}`):a==="minQuantity"&&r.push(`Min. ilość: ${u}`);if(t.amount&&!t.old_status&&r.push(`Kwota: ${t.amount} PLN`),t.type&&!t.amount){const a=t.custom_type||fe(t.type);r.push(`Typ: ${a}`)}else if(t.bill_type&&!t.old_status){const a=t.custom_type||fe(t.bill_type);r.push(`Typ: ${a}`)}return t.old_status&&t.new_status&&r.push(`Status: ${t.old_status} → ${t.new_status}`),t.meter_value&&r.push(`Licznik: ${t.meter_value}`),t.quantity&&s.action.includes("supply")&&r.push(`Ilość: ${t.quantity}`),t.period_start&&t.period_end&&r.push(`Okres: ${t.period_start} - ${t.period_end}`),r.length>3?r.slice(0,3).join(" • ")+" i więcej...":r.join(" • ")}function xs(s){return{bill:"rachunek",chore:"obowiązek",user:"użytkownika",role:"rolę",group:"grupę",supply:"zaopatrzenie",loan:"pożyczkę"}[s]||s}function H(s){return{userName:"Nazwa użytkownika",userEmail:"Email użytkownika",targetUser:"Zmieniony użytkownik",oldRole:"Poprzednia rola",newRole:"Nowa rola",userId:"ID użytkownika",roleName:"Nazwa roli",displayName:"Nazwa wyświetlana",oldDisplayName:"Poprzednia nazwa",newDisplayName:"Nowa nazwa",oldPermissions:"Poprzednie uprawnienia",newPermissions:"Nowe uprawnienia",permissions:"Uprawnienia",billType:"Typ rachunku",bill_type:"Typ rachunku",type:"Typ",amount:"Kwota (PLN)",period:"Okres",period_start:"Początek okresu",period_end:"Koniec okresu",oldStatus:"Poprzedni status",newStatus:"Nowy status",old_status:"Poprzedni status",new_status:"Nowy status",status:"Status",bill_id:"ID rachunku",meter_value:"Wartość licznika",source:"Źródło",choreName:"Nazwa obowiązku",name:"Nazwa",description:"Opis",assignee:"Przypisany do",dueDate:"Termin",groupName:"Nazwa grupy",weight:"Waga",itemName:"Nazwa pozycji",quantity:"Ilość",unit:"Jednostka",createdAt:"Utworzono",updatedAt:"Zaktualizowano",deletedAt:"Usunięto",id:"ID",error:"Błąd"}[s]||s}async function tt(){pt.value=!0;try{const s=await y.get("/roles");ke.value=s.data||[]}catch(s){console.error("Failed to load roles:",s)}finally{pt.value=!1}}async function hs(){try{const s=await y.get("/permissions");xt.value=s.data||{}}catch(s){console.error("Failed to load permissions:",s)}}function zs(s){_.value={id:s.id,name:s.name,displayName:s.displayName,permissions:[...s.permissions]},D.value=!0}async function _s(){try{await y.post("/roles",{name:_.value.name,displayName:_.value.displayName,permissions:_.value.permissions}),re.value=!1,_.value={id:"",name:"",displayName:"",permissions:[]},await tt(),alert("Rola utworzona pomyślnie")}catch(s){alert("Nie udało się utworzyć roli: "+(s.response?.data?.error||s.message))}}async function js(){try{await y.patch(`/roles/${_.value.id}`,{displayName:_.value.displayName,permissions:_.value.permissions}),D.value=!1,_.value={id:"",name:"",displayName:"",permissions:[]},await tt(),alert("Rola zaktualizowana pomyślnie")}catch(s){alert("Nie udało się zaktualizować roli: "+(s.response?.data?.error||s.message))}}async function Us(s){if(confirm("Czy na pewno chcesz usunąć tę rolę?"))try{await y.delete(`/roles/${s}`),await tt(),alert("Rola usunięta pomyślnie")}catch(t){alert("Nie udało się usunąć roli: "+(t.response?.data?.error||t.message))}}async function st(){He.value=!0;try{const s=await y.get("/approvals/pending");mt.value=s.data||[]}catch(s){console.error("Failed to load approvals:",s)}finally{He.value=!1}}async function Ns(s){try{await y.post(`/approvals/${s}/approve`),await st(),alert("Wniosek zatwierdzony")}catch(t){alert("Nie udało się zatwierdzić wniosku: "+(t.response?.data?.error||t.message))}}async function Cs(s){try{await y.post(`/approvals/${s}/reject`),await st(),alert("Wniosek odrzucony")}catch(t){alert("Nie udało się odrzucić wniosku: "+(t.response?.data?.error||t.message))}}function zt(s){if(!s)return"";const t=ke.value.find(r=>r.name===s);return t?t.displayName:s}return(s,t)=>{const r=Es("router-link");return l(),n("div",null,[e("h1",Bs,o(s.$t("settings.title")),1),e("div",Gs,[e("h2",Ws,o(s.$t("settings.profile")),1),e("form",{onSubmit:x(Lt,["prevent"]),class:"space-y-4"},[e("div",null,[e("label",Ks,o(s.$t("settings.name")),1),m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>E.value.name=a),required:"",class:"input"},null,512),[[k,E.value.name]])]),e("div",null,[e("label",Hs,o(s.$t("settings.email")),1),m(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>E.value.email=a),type:"email",required:"",class:"input"},null,512),[[k,E.value.email]])]),e("div",null,[t[58]||(t[58]=e("label",{class:"block text-sm font-medium mb-2"},"Rola",-1)),e("input",{value:zt(d(w).user?.role),disabled:"",class:"input bg-gray-700"},null,8,Js)]),je.value?(l(),n("div",Ys,o(je.value),1)):c("",!0),Ue.value?(l(),n("div",Qs,o(Ue.value),1)):c("",!0),e("button",{type:"submit",disabled:_e.value,class:"btn btn-primary"},o(_e.value?"Zapisywanie...":"Zapisz profil"),9,Xs)],32)]),e("div",ea,[e("h2",ta,o(s.$t("settings.changePassword")),1),e("form",{onSubmit:x(It,["prevent"]),class:"space-y-4"},[e("div",null,[e("label",sa,o(s.$t("settings.currentPassword")),1),m(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>L.value.currentPassword=a),type:"password",required:"",class:"input"},null,512),[[k,L.value.currentPassword]])]),e("div",null,[e("label",aa,o(s.$t("settings.newPassword")),1),m(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>L.value.newPassword=a),type:"password",required:"",class:"input"},null,512),[[k,L.value.newPassword]])]),he.value?(l(),n("div",oa,o(he.value),1)):c("",!0),ze.value?(l(),n("div",la,o(ze.value),1)):c("",!0),e("button",{type:"submit",disabled:ot.value,class:"btn btn-primary"},o(s.$t("settings.save")),9,na)],32)]),e("div",ia,[e("div",ra,[t[60]||(t[60]=e("div",null,[e("h2",{class:"text-xl font-semibold"},"Klucze dostępu (Passkeys)"),e("p",{class:"text-sm text-gray-400 mt-1"},"Szybsze i bezpieczniejsze logowanie bez hasła")],-1)),Oe.value?(l(),n("button",{key:0,onClick:t[4]||(t[4]=a=>oe.value=!0),class:"btn btn-primary flex items-center gap-2"},[p(d(Nt),{class:"w-4 h-4"}),t[59]||(t[59]=$(" Dodaj passkey ",-1))])):c("",!0)]),Oe.value?ut.value?(l(),n("div",da,"Ładowanie...")):ve.value.length===0?(l(),n("div",ca,[p(d(qs),{class:"w-12 h-12 mx-auto mb-2 opacity-50"}),t[62]||(t[62]=e("p",null,"Nie masz jeszcze żadnych passkeys",-1)),t[63]||(t[63]=e("p",{class:"text-sm mt-2"},"Dodaj passkey, aby logować się bez hasła",-1))])):(l(),n("div",pa,[(l(!0),n(f,null,g(ve.value,(a,u)=>(l(),n("div",{key:u,class:"flex justify-between items-center p-4 bg-gray-700/30 rounded-xl"},[e("div",ma,[e("div",ya,[p(d(Nt),{class:"w-5 h-5 text-purple-400"})]),e("div",null,[e("p",va,o(a.name),1),e("p",wa,"Utworzony: "+o(a.createdAt),1),e("p",ba,"Ostatnio użyty: "+o(a.lastUsedAt),1)])]),e("button",{onClick:b=>os(u),class:"btn btn-sm btn-secondary"},[p(d(de),{class:"w-3 h-3"})],8,ka)]))),128))])):(l(),n("div",ua,[p(d(Zs),{class:"w-12 h-12 mx-auto mb-2 opacity-50"}),t[61]||(t[61]=e("p",null,"Passkeys nie są obsługiwane w tej przeglądarce",-1))])),U.value?(l(),n("div",fa,o(U.value),1)):c("",!0),le.value?(l(),n("div",ga,o(le.value),1)):c("",!0)]),oe.value?(l(),n("div",{key:0,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",onClick:t[8]||(t[8]=x(a=>oe.value=!1,["self"]))},[e("div",xa,[e("div",ha,[t[64]||(t[64]=e("h2",{class:"text-2xl font-bold"},"Dodaj passkey",-1)),e("button",{onClick:t[5]||(t[5]=a=>oe.value=!1),class:"text-gray-400 hover:text-white"},[p(d(O),{class:"w-6 h-6"})])]),e("form",{onSubmit:x(as,["prevent"]),class:"space-y-4"},[e("div",null,[t[65]||(t[65]=e("label",{class:"block text-sm font-medium mb-2"},"Nazwa passkey (opcjonalnie)",-1)),m(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>qe.value=a),type:"text",class:"input",placeholder:"np. MacBook Pro, iPhone"},null,512),[[k,qe.value]]),t[66]||(t[66]=e("p",{class:"text-xs text-gray-400 mt-1"},"Pomaga rozpoznać urządzenie",-1))]),U.value?(l(),n("div",za,o(U.value),1)):c("",!0),e("div",_a,[e("button",{type:"submit",disabled:Ze.value,class:"btn btn-primary flex-1"},o(Ze.value?"Dodawanie...":"Dodaj"),9,ja),e("button",{type:"button",onClick:t[7]||(t[7]=a=>oe.value=!1),class:"btn btn-outline"}," Anuluj ")])],32)])])):c("",!0),e("div",Ua,[e("h2",Na,o(s.$t("settings.sessions")),1),dt.value?(l(),n("div",Ca,o(s.$t("common.loading")),1)):ne.value.length===0?(l(),n("div",$a,o(s.$t("settings.noSessions")),1)):(l(),n("div",Aa,[(l(!0),n(f,null,g(ne.value,a=>(l(),n("div",{key:a.id,class:"border border-gray-700 rounded-lg p-4"},[e("div",Pa,[e("div",Da,[e("div",Sa,[e("h3",Ta,o(a.name),1),rs(a)?(l(),n("span",Ea,o(s.$t("settings.currentSession")),1)):c("",!0)]),e("div",Ra,[e("p",null,o(s.$t("settings.createdAt"))+": "+o(et(a.createdAt)),1),e("p",null,o(s.$t("settings.lastUsed"))+": "+o(et(a.lastUsedAt)),1),a.ipAddress?(l(),n("p",La,"IP: "+o(a.ipAddress),1)):c("",!0)])]),e("div",Fa,[e("button",{onClick:u=>us(a),class:"btn btn-sm btn-outline",title:s.$t("settings.renameSession")},[p(d(at),{class:"w-4 h-4"})],8,Ia),e("button",{onClick:u=>cs(a.id),class:"btn btn-sm btn-secondary",title:s.$t("settings.deleteSession")},[p(d(de),{class:"w-4 h-4"})],8,Ma)])])]))),128)),ne.value.length>1?(l(),n("div",Va,[e("button",{onClick:ps,disabled:Ge.value,class:"btn btn-secondary w-full"},o(Ge.value?"Wylogowywanie...":"Wyloguj ze wszystkich urządzeń"),9,Oa)])):c("",!0)]))]),ie.value?(l(),n("div",{key:1,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",onClick:t[12]||(t[12]=x(a=>ie.value=!1,["self"]))},[e("div",Za,[e("div",qa,[e("h2",Ba,o(s.$t("settings.renameSession")),1),e("button",{onClick:t[9]||(t[9]=a=>ie.value=!1),class:"text-gray-400 hover:text-white"},[p(d(O),{class:"w-6 h-6"})])]),e("form",{onSubmit:x(ds,["prevent"]),class:"space-y-4"},[e("div",null,[e("label",Ga,o(s.$t("settings.sessionName")),1),m(e("input",{"onUpdate:modelValue":t[10]||(t[10]=a=>we.value.name=a),type:"text",required:"",class:"input",placeholder:"Chrome on Windows"},null,512),[[k,we.value.name]])]),e("div",Wa,[e("button",{type:"submit",disabled:Be.value,class:"btn btn-primary flex-1"},o(Be.value?s.$t("common.saving"):s.$t("common.save")),9,Ka),e("button",{type:"button",onClick:t[11]||(t[11]=a=>ie.value=!1),class:"btn btn-outline"},o(s.$t("common.cancel")),1)])],32)])])):c("",!0),e("div",Ha,[e("div",Ja,[e("div",Ya,[p(d(Vs),{class:"w-5 h-5 text-purple-400"}),e("h2",Qa,o(s.$t("settings.language")),1)]),e("p",Xa,o(s.$t("settings.languageDescription")),1)]),e("div",eo,[(l(!0),n(f,null,g(d(gt),a=>(l(),n("button",{key:a.code,onClick:u=>d(Rt)(a.code),class:Z(["flex items-center gap-2 px-4 py-3 rounded-xl border transition-all",d(ft)===a.code?"border-purple-500 bg-purple-600/20 text-white":"border-gray-700 bg-gray-800 hover:bg-gray-700 text-gray-300"])},[e("span",so,o(a.flag),1),e("span",ao,o(a.name),1),d(ft)===a.code?(l(),n("svg",oo,[...t[67]||(t[67]=[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)])])):c("",!0)],10,to))),128))])]),d(w).isAdmin?(l(),n("div",lo,[e("div",no,[e("div",io,[e("h2",ro,o(s.$t("settings.appCustomization")),1),e("p",uo,o(s.$t("settings.appCustomizationDescription")),1)]),e("form",{onSubmit:x(Ft,["prevent"]),class:"space-y-4"},[e("div",null,[e("label",co,o(s.$t("settings.appName")),1),m(e("input",{"onUpdate:modelValue":t[13]||(t[13]=a=>F.value.appName=a),required:"",class:"input",placeholder:"Holy Home"},null,512),[[k,F.value.appName]]),e("p",po,o(s.$t("settings.appNameDescription")),1)]),e("div",mo,[e("h3",yo,o(s.$t("settings.languageSettings")),1),e("div",vo,[e("div",null,[e("label",wo,o(s.$t("settings.defaultLanguage")),1),m(e("select",{"onUpdate:modelValue":t[14]||(t[14]=a=>F.value.defaultLanguage=a),class:"input"},[(l(!0),n(f,null,g(d(gt),a=>(l(),n("option",{key:a.code,value:a.code},o(a.flag)+" "+o(a.name),9,bo))),128))],512),[[S,F.value.defaultLanguage]]),e("p",ko,o(s.$t("settings.defaultLanguageDescription")),1)]),e("label",fo,[m(e("input",{type:"checkbox","onUpdate:modelValue":t[15]||(t[15]=a=>F.value.disableAutoDetect=a),class:"w-5 h-5 rounded border-gray-600 bg-gray-700 text-purple-600 focus:ring-purple-500"},null,512),[[_t,F.value.disableAutoDetect]]),e("div",null,[e("span",go,o(s.$t("settings.disableAutoDetect")),1),e("p",xo,o(s.$t("settings.disableAutoDetectDescription")),1)])])])]),Se.value?(l(),n("div",ho,o(Se.value),1)):c("",!0),Te.value?(l(),n("div",zo,o(Te.value),1)):c("",!0),e("button",{type:"submit",disabled:De.value,class:"btn btn-primary"},o(De.value?"Zapisywanie...":"Zapisz ustawienia"),9,_o)],32)]),e("div",jo,[e("div",Uo,[t[69]||(t[69]=e("h2",{class:"text-xl font-semibold"},"Zarządzanie użytkownikami",-1)),e("button",{onClick:t[16]||(t[16]=a=>X.value=!0),class:"btn btn-primary flex items-center gap-2"},[p(d(jt),{class:"w-4 h-4"}),t[68]||(t[68]=$(" Dodaj użytkownika ",-1))])]),lt.value?(l(),n("div",No,"Ładowanie...")):q.value.length===0?(l(),n("div",Co,"Brak użytkowników")):(l(),n("div",$o,[e("table",Ao,[t[70]||(t[70]=e("thead",{class:"border-b border-gray-700"},[e("tr",{class:"text-left"},[e("th",{class:"pb-3 px-2 sm:px-0"},"Nazwa"),e("th",{class:"pb-3 px-2 sm:px-0 hidden md:table-cell"},"Email"),e("th",{class:"pb-3 px-2 sm:px-0"},"Rola"),e("th",{class:"pb-3 px-2 sm:px-0 hidden lg:table-cell"},"Grupa"),e("th",{class:"pb-3 px-2 sm:px-0 hidden sm:table-cell"},"Status"),e("th",{class:"pb-3 px-2 sm:px-0"},"Akcje")])],-1)),e("tbody",null,[(l(!0),n(f,null,g(q.value,a=>(l(),n("tr",{key:a.id,class:"border-b border-gray-700"},[e("td",Po,[e("div",null,o(a.name),1),e("div",Do,o(a.email),1)]),e("td",So,o(a.email),1),e("td",To,[e("span",{class:Z([a.role==="ADMIN"?"text-purple-400":"text-gray-400","text-xs sm:text-sm"])},o(zt(a.role)),3)]),e("td",Eo,o(a.groupName||"-"),1),e("td",Ro,[e("span",{class:Z([a.isActive?"text-green-400":"text-red-400","text-xs sm:text-sm"])},o(a.isActive?"Aktywny":"Nieaktywny"),3)]),e("td",Lo,[e("div",Fo,[e("button",{onClick:u=>Gt(a.id),class:"text-blue-400 hover:text-blue-300 text-xs sm:text-sm whitespace-nowrap"}," Dashboard ",8,Io),e("button",{onClick:u=>Vt(a),class:"btn btn-sm btn-outline",disabled:a.id===d(w).user.id},[p(d(at),{class:"w-3 h-3"})],8,Mo),e("button",{onClick:u=>Zt(a),class:Z(["btn btn-sm text-xs",a.isActive?"btn-secondary":"btn-primary"]),disabled:a.id===d(w).user.id},o(a.isActive?"Dezaktywuj":"Aktywuj"),11,Vo),e("button",{onClick:u=>qt(a),class:"btn btn-sm btn-outline text-xs",disabled:a.id===d(w).user.id,title:"Wymuś zmianę hasła"}," Zmień hasło ",8,Oo),e("button",{onClick:u=>Wt(a),class:"btn btn-sm btn-primary text-xs",disabled:a.id===d(w).user.id,title:"Generuj link do resetowania hasła"}," Link resetowania ",8,Zo),e("button",{onClick:u=>Bt(a),class:"btn btn-sm btn-secondary",disabled:a.id===d(w).user.id||a.isActive,title:"Usuń użytkownika (tylko nieaktywnych)"},[p(d(de),{class:"w-3 h-3"})],8,qo)])])]))),128))])])]))]),e("div",Bo,[e("div",Go,[t[72]||(t[72]=e("h2",{class:"text-xl font-semibold"},"Zarządzanie grupami",-1)),e("button",{onClick:t[17]||(t[17]=a=>Ee.value=!0),class:"btn btn-primary flex items-center gap-2"},[p(d(Ct),{class:"w-4 h-4"}),t[71]||(t[71]=$(" Dodaj grupę ",-1))])]),nt.value?(l(),n("div",Wo,"Ładowanie...")):Ne.value.length===0?(l(),n("div",Ko,"Brak grup")):(l(),n("div",Ho,[(l(!0),n(f,null,g(Ne.value,a=>(l(),n("div",{key:a.id,class:"p-4 bg-gray-700/30 rounded-xl"},[e("div",Jo,[e("div",Yo,[e("p",Qo,o(a.name),1),e("p",Xo,"Waga: "+o(parseFloat(a.weight.$numberDecimal||a.weight||1).toFixed(2)),1)]),e("div",el,[e("button",{onClick:u=>Xt(a),class:"btn btn-sm btn-outline flex-1 sm:flex-initial"},[p(d(Ct),{class:"w-3 h-3 mr-1"}),t[73]||(t[73]=e("span",{class:"text-xs"},"Użytkownicy",-1))],8,tl),e("button",{onClick:u=>Jt(a),class:"btn btn-sm btn-outline"},[p(d(at),{class:"w-3 h-3"})],8,sl),e("button",{onClick:u=>Qt(a.id),class:"btn btn-sm btn-secondary"},[p(d(de),{class:"w-3 h-3"})],8,al)])]),Xe(a.id).length>0?(l(),n("div",ol,[t[74]||(t[74]=e("p",{class:"text-xs text-gray-400 mb-1"},"Członkowie:",-1)),e("div",ll,[(l(!0),n(f,null,g(Xe(a.id),u=>(l(),n("span",{key:u.id,class:"text-xs px-2 py-1 bg-gray-800 rounded"},o(u.name),1))),128))])])):c("",!0)]))),128))]))]),e("div",nl,[e("div",il,[t[75]||(t[75]=e("div",null,[e("h2",{class:"text-xl font-semibold"},"Logi audytu"),e("p",{class:"text-sm text-gray-400 mt-1"},"Historia wszystkich akcji użytkowników i administratorów")],-1)),e("button",{onClick:N,disabled:Ke.value,class:"btn btn-outline btn-sm"},[p(d(At),{class:"w-4 h-4"})],8,rl)]),e("div",ul,[e("div",dl,[m(e("input",{"onUpdate:modelValue":t[18]||(t[18]=a=>v.value.search=a),onInput:ws,type:"text",placeholder:"Szukaj w logach (użytkownik, akcja, zasób...)...",class:"input pl-10"},null,544),[[k,v.value.search]]),p(d(Os),{class:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]),e("div",cl,[m(e("select",{"onUpdate:modelValue":t[19]||(t[19]=a=>v.value.userEmail=a),onChange:N,class:"input"},[t[76]||(t[76]=e("option",{value:""},"Wszyscy użytkownicy",-1)),(l(!0),n(f,null,g(q.value,a=>(l(),n("option",{key:a.id,value:a.email},o(a.name)+" ("+o(a.email)+")",9,pl))),128))],544),[[S,v.value.userEmail]]),m(e("select",{"onUpdate:modelValue":t[20]||(t[20]=a=>v.value.action=a),onChange:N,class:"input"},[...t[77]||(t[77]=[Ut('<option value="">Wszystkie akcje</option><optgroup label="Rachunki"><option value="create_bill">Tworzenie rachunku</option><option value="post_bill">Publikacja rachunku</option><option value="close_bill">Zamknięcie rachunku</option><option value="delete_bill">Usunięcie rachunku</option></optgroup><optgroup label="Odczyty"><option value="create_reading">Dodanie odczytu</option><option value="delete_consumption">Usunięcie odczytu</option></optgroup><optgroup label="Zakupy"><option value="create_supply">Dodanie artykułu</option><option value="update_supply">Aktualizacja artykułu</option><option value="delete_supply">Usunięcie artykułu</option><option value="purchase_supply">Zakup artykułu</option></optgroup><optgroup label="Pożyczki"><option value="create_loan">Tworzenie pożyczki</option><option value="payment_loan">Spłata pożyczki</option></optgroup><optgroup label="Obowiązki"><option value="create_chore">Tworzenie obowiązku</option><option value="update_chore">Aktualizacja obowiązku</option><option value="delete_chore">Usunięcie obowiązku</option><option value="complete_chore">Wykonanie obowiązku</option></optgroup><optgroup label="Użytkownicy i role"><option value="user.create">Tworzenie użytkownika</option><option value="user.update">Aktualizacja użytkownika</option><option value="user.delete">Usunięcie użytkownika</option><option value="role.create">Tworzenie roli</option><option value="role.update">Aktualizacja roli</option><option value="role.delete">Usunięcie roli</option></optgroup>',7)])],544),[[S,v.value.action]]),m(e("select",{"onUpdate:modelValue":t[21]||(t[21]=a=>v.value.resourceType=a),onChange:N,class:"input"},[...t[78]||(t[78]=[Ut('<option value="">Wszystkie zasoby</option><option value="bill">Rachunek</option><option value="consumption">Odczyt</option><option value="supply">Zakup</option><option value="loan">Pożyczka</option><option value="chore">Obowiązek</option><option value="user">Użytkownik</option><option value="role">Rola</option>',8)])],544),[[S,v.value.resourceType]]),m(e("select",{"onUpdate:modelValue":t[22]||(t[22]=a=>v.value.status=a),onChange:N,class:"input"},[...t[79]||(t[79]=[e("option",{value:""},"Wszystkie statusy",-1),e("option",{value:"success"},"✓ Sukces",-1),e("option",{value:"failure"},"✗ Błąd",-1)])],544),[[S,v.value.status]])]),e("div",ml,[m(e("input",{"onUpdate:modelValue":t[23]||(t[23]=a=>v.value.dateFrom=a),onChange:N,type:"date",placeholder:"Data od",class:"input"},null,544),[[k,v.value.dateFrom]]),m(e("input",{"onUpdate:modelValue":t[24]||(t[24]=a=>v.value.dateTo=a),onChange:N,type:"date",placeholder:"Data do",class:"input"},null,544),[[k,v.value.dateTo]]),m(e("select",{"onUpdate:modelValue":t[25]||(t[25]=a=>ct.value=a),onChange:N,class:"input"},[...t[80]||(t[80]=[e("option",{value:10},"10 wpisów",-1),e("option",{value:25},"25 wpisów",-1),e("option",{value:50},"50 wpisów",-1),e("option",{value:100},"100 wpisów",-1),e("option",{value:200},"200 wpisów",-1)])],544),[[S,ct.value]])]),e("div",{class:"flex justify-end"},[e("button",{onClick:bs,class:"btn btn-outline btn-sm"}," Wyczyść filtry ")])]),Ke.value?(l(),n("div",yl,"Ładowanie...")):We.value.length===0?(l(),n("div",vl,"Brak logów")):(l(),n("div",wl,[(l(!0),n(f,null,g(We.value,a=>(l(),n("div",{key:a.id,class:"p-4 rounded-lg bg-gray-700/30 hover:bg-gray-700/50 transition-colors cursor-pointer",onClick:u=>ks(a.id)},[e("div",kl,[e("div",fl,[e("div",gl,[e("span",xl,o(gs(a)),1),e("span",{class:Z([a.status==="success"?"text-green-400":"text-red-400","text-xs"])},o(a.status==="success"?"✓":"✗"),3)]),ht(a)?(l(),n("div",hl,o(ht(a)),1)):c("",!0),e("div",zl,[e("span",null,o(a.userName||a.userEmail),1),t[81]||(t[81]=e("span",null,"•",-1)),e("span",null,o(et(a.createdAt)),1),a.resourceType&&bt(a)?(l(),n("span",_l,"•")):c("",!0),a.resourceType&&a.resourceId&&a.status==="success"&&bt(a)?(l(),Rs(r,{key:1,to:bt(a),onClick:t[26]||(t[26]=x(()=>{},["stop"])),class:"text-purple-400 hover:text-purple-300 underline"},{default:Ls(()=>[$(" Zobacz "+o(xs(a.resourceType)),1)]),_:2},1032,["to"])):c("",!0)]),be.value.has(a.id)&&a.details&&Object.keys(a.details).length>0?(l(),n("div",jl,[e("div",Ul,[(l(!0),n(f,null,g(fs(a),(u,b)=>(l(),n("div",{key:b},[e("div",Nl,o(H(b)),1),e("div",Cl,o(u),1)]))),128))])])):c("",!0)]),(l(),n("svg",{class:Z(["w-5 h-5 text-gray-400 transition-transform flex-shrink-0",{"rotate-180":be.value.has(a.id)}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[82]||(t[82]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))])],8,bl))),128)),e("div",$l," Pokazano "+o(We.value.length)+" z ostatnich wpisów ",1)]))]),e("div",Al,[e("div",Pl,[t[84]||(t[84]=e("div",{class:"flex-1"},[e("h2",{class:"text-xl font-semibold"},"Zarządzanie rolami i uprawnieniami"),e("p",{class:"text-sm text-gray-400 mt-1"},"Konfiguruj role użytkowników i ich uprawnienia")],-1)),e("button",{onClick:t[27]||(t[27]=a=>re.value=!0),class:"btn btn-primary btn-sm flex items-center gap-2 w-full sm:w-auto"},[p(d(jt),{class:"w-4 h-4"}),t[83]||(t[83]=$(" Nowa rola ",-1))])]),pt.value?(l(),n("div",Dl,"Ładowanie...")):(l(),n("div",Sl,[(l(!0),n(f,null,g(ke.value,a=>(l(),n("div",{key:a.id,class:"p-4 bg-gray-700/30 rounded-xl"},[e("div",Tl,[e("div",El,[e("div",Rl,[e("h3",Ll,o(a.displayName),1),a.name==="ADMIN"?(l(),n("span",Fl,"Niezmienne")):c("",!0)]),e("p",Il,o(a.permissions.length)+" uprawnień",1)]),e("div",Ml,[a.name!=="ADMIN"?(l(),n("button",{key:0,onClick:u=>zs(a),class:"btn btn-sm btn-outline flex items-center justify-center gap-1"},[p(d(at),{class:"w-3 h-3"}),t[85]||(t[85]=e("span",{class:"text-xs"},"Edytuj",-1))],8,Vl)):c("",!0),a.name!=="ADMIN"?(l(),n("button",{key:1,onClick:u=>Us(a.id),class:"btn btn-sm btn-secondary flex items-center justify-center gap-1"},[p(d(de),{class:"w-3 h-3"}),t[86]||(t[86]=e("span",{class:"text-xs"},"Usuń",-1))],8,Ol)):c("",!0),a.name==="ADMIN"?(l(),n("span",Zl,"Rola administratora (chroniona)")):c("",!0)])]),e("div",ql,[(l(!0),n(f,null,g(a.permissions.slice(0,5),u=>(l(),n("span",{key:u,class:"text-xs px-2 py-1 bg-gray-800 rounded whitespace-nowrap"},o(ue(u)),1))),128)),a.permissions.length>5?(l(),n("span",Bl," +"+o(a.permissions.length-5)+" więcej ",1)):c("",!0)])]))),128))]))]),e("div",Gl,[e("div",Wl,[t[87]||(t[87]=e("div",null,[e("h2",{class:"text-xl font-semibold"},"Oczekujące zatwierdzenia"),e("p",{class:"text-sm text-gray-400 mt-1"},"Wnioski użytkowników wymagające zgody administratora")],-1)),e("button",{onClick:st,disabled:He.value,class:"btn btn-outline btn-sm"},[p(d(At),{class:"w-4 h-4"})],8,Kl)]),He.value?(l(),n("div",Hl,"Ładowanie...")):mt.value.length===0?(l(),n("div",Jl,"Brak oczekujących wniosków")):(l(),n("div",Yl,[(l(!0),n(f,null,g(mt.value,a=>(l(),n("div",{key:a.id,class:"p-4 bg-gray-700/30 rounded-xl"},[e("div",Ql,[e("div",Xl,[e("div",en,[e("span",tn,o(a.userName||a.userEmail),1),t[88]||(t[88]=e("span",{class:"text-sm text-gray-400"},"•",-1)),e("span",sn,o(a.action),1)]),e("p",an,o(et(a.createdAt)),1)]),e("div",on,[e("button",{onClick:u=>Ns(a.id),class:"btn btn-sm btn-primary"}," Zatwierdź ",8,ln),e("button",{onClick:u=>Cs(a.id),class:"btn btn-sm btn-secondary"}," Odrzuć ",8,nn)])])]))),128))]))]),e("div",rn,[t[95]||(t[95]=e("div",{class:"mb-4"},[e("h2",{class:"text-xl font-semibold mb-1"},"Kopia zapasowa i przywracanie"),e("p",{class:"text-sm text-gray-400"},"Eksportuj lub importuj wszystkie dane systemu")],-1)),e("div",un,[e("div",dn,[e("button",{onClick:t[28]||(t[28]=a=>Ae.value=!Ae.value),class:"w-full p-4 bg-gray-700/30 hover:bg-gray-700/50 transition-colors flex items-center justify-between"},[e("div",cn,[e("div",pn,[p(d($t),{class:"w-5 h-5 text-green-400"})]),t[89]||(t[89]=e("div",{class:"text-left"},[e("h3",{class:"font-medium"},"Eksportuj dane"),e("p",{class:"text-xs text-gray-400"},"Pobierz pełną kopię zapasową")],-1))]),(l(),n("svg",{class:Z(["w-5 h-5 transition-transform",{"rotate-180":Ae.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[90]||(t[90]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),Ae.value?(l(),n("div",mn,[t[91]||(t[91]=e("p",{class:"text-sm text-gray-400 mb-3"}," Pobierz pełną kopię zapasową wszystkich danych (użytkownicy, rachunki, historia, passkeys) ",-1)),e("button",{onClick:ls,disabled:Ce.value,class:"btn btn-primary flex items-center gap-2"},[p(d($t),{class:"w-4 h-4"}),$(" "+o(Ce.value?"Eksportowanie...":"Pobierz kopię zapasową"),1)],8,yn)])):c("",!0)]),e("div",vn,[e("button",{onClick:t[29]||(t[29]=a=>Pe.value=!Pe.value),class:"w-full p-4 bg-gray-700/30 hover:bg-gray-700/50 transition-colors flex items-center justify-between"},[e("div",wn,[e("div",bn,[p(d(Pt),{class:"w-5 h-5 text-red-400"})]),t[92]||(t[92]=e("div",{class:"text-left"},[e("h3",{class:"font-medium text-red-400"},"Importuj dane (NIEBEZPIECZNE)"),e("p",{class:"text-xs text-gray-400"},"Zastąp wszystkie dane kopią zapasową")],-1))]),(l(),n("svg",{class:Z(["w-5 h-5 transition-transform",{"rotate-180":Pe.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[93]||(t[93]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),Pe.value?(l(),n("div",kn,[t[94]||(t[94]=e("p",{class:"text-sm text-gray-400 mb-3"},[e("strong",{class:"text-red-400"},"OSTRZEŻENIE:"),$(" Operacja usunie WSZYSTKIE obecne dane i zastąpi je danymi z kopii zapasowej. Tej operacji nie można cofnąć! ")],-1)),e("div",fn,[e("input",{type:"file",ref_key:"backupFileInput",ref:ce,accept:".json",onChange:ns,class:"hidden"},null,544),e("button",{onClick:t[30]||(t[30]=a=>s.$refs.backupFileInput.click()),disabled:$e.value,class:"btn btn-secondary flex items-center gap-2"},[p(d(Pt),{class:"w-4 h-4"}),$(" "+o($e.value?"Importowanie...":"Wybierz plik kopii zapasowej"),1)],8,gn),B.value?(l(),n("p",xn," Wybrany plik: "+o(B.value.name),1)):c("",!0)])])):c("",!0)]),Y.value?(l(),n("div",hn,[e("p",zn,o(Y.value),1)])):c("",!0),Q.value?(l(),n("div",_n,[e("p",jn,o(Q.value),1)])):c("",!0)])])])):c("",!0),X.value?(l(),n("div",{key:3,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",onClick:t[38]||(t[38]=x(a=>X.value=!1,["self"]))},[e("div",Un,[e("div",Nn,[t[96]||(t[96]=e("h2",{class:"text-2xl font-bold"},"Nowy użytkownik",-1)),e("button",{onClick:t[31]||(t[31]=a=>X.value=!1),class:"text-gray-400 hover:text-white"},[p(d(O),{class:"w-6 h-6"})])]),e("form",{onSubmit:x(Mt,["prevent"]),class:"space-y-4"},[e("div",null,[t[97]||(t[97]=e("label",{class:"block text-sm font-medium mb-2"},"Nazwa",-1)),m(e("input",{"onUpdate:modelValue":t[32]||(t[32]=a=>h.value.name=a),required:"",class:"input"},null,512),[[k,h.value.name]])]),e("div",null,[t[98]||(t[98]=e("label",{class:"block text-sm font-medium mb-2"},"Email",-1)),m(e("input",{"onUpdate:modelValue":t[33]||(t[33]=a=>h.value.email=a),type:"email",required:"",class:"input"},null,512),[[k,h.value.email]])]),d(w).authConfig.allowUsernameLogin||d(w).authConfig.requireUsername?(l(),n("div",Cn,[e("label",$n,[t[99]||(t[99]=$(" Nazwa użytkownika ",-1)),d(w).authConfig.requireUsername?c("",!0):(l(),n("span",An,"(opcjonalnie)"))]),m(e("input",{"onUpdate:modelValue":t[34]||(t[34]=a=>h.value.username=a),required:d(w).authConfig.requireUsername,class:"input",placeholder:"np. jan_kowalski"},null,8,Pn),[[k,h.value.username]])])):c("",!0),e("div",null,[t[100]||(t[100]=e("label",{class:"block text-sm font-medium mb-2"},"Hasło",-1)),m(e("input",{"onUpdate:modelValue":t[35]||(t[35]=a=>h.value.password=a),type:"password",required:"",class:"input"},null,512),[[k,h.value.password]])]),e("div",null,[t[101]||(t[101]=e("label",{class:"block text-sm font-medium mb-2"},"Rola",-1)),m(e("select",{"onUpdate:modelValue":t[36]||(t[36]=a=>h.value.role=a),required:"",class:"input"},[(l(!0),n(f,null,g(ke.value,a=>(l(),n("option",{key:a.id,value:a.name},o(a.displayName),9,Dn))),128))],512),[[S,h.value.role]])]),M.value?(l(),n("div",Sn,o(M.value),1)):c("",!0),e("div",Tn,[e("button",{type:"submit",disabled:Ie.value,class:"btn btn-primary flex-1"},o(Ie.value?"Tworzenie...":"Utwórz"),9,En),e("button",{type:"button",onClick:t[37]||(t[37]=a=>X.value=!1),class:"btn btn-outline"}," Anuluj ")])],32)])])):c("",!0),it.value?(l(),n("div",{key:4,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",onClick:x(Ye,["self"])},[e("div",Rn,[e("div",Ln,[t[102]||(t[102]=e("h2",{class:"text-2xl font-bold"},"Generuj link resetowania hasła",-1)),e("button",{onClick:Ye,class:"text-gray-400 hover:text-white"},[p(d(O),{class:"w-6 h-6"})])]),te.value?(l(),n("div",Zn,[t[108]||(t[108]=e("p",{class:"text-sm text-green-400 mb-4"}," Link został wygenerowany pomyślnie! ",-1)),e("div",null,[t[106]||(t[106]=e("label",{class:"block text-sm font-medium mb-2"},"Link resetowania hasła:",-1)),e("div",qn,[e("input",{value:te.value,readonly:"",class:"input flex-1 text-sm",ref_key:"resetLinkInput",ref:rt},null,8,Bn),e("button",{onClick:Ht,class:"btn btn-primary"},o(me.value?"Skopiowano!":"Kopiuj"),1)])]),e("p",Gn,[t[107]||(t[107]=$(" Link wygaśnie za: ",-1)),e("strong",null,o(G.value)+" "+o(G.value===1?"minutę":G.value<5?"minuty":"minut"),1)]),e("div",{class:"flex gap-3"},[e("button",{onClick:Ye,class:"btn btn-primary flex-1"}," Zamknij ")])])):(l(),n("div",Fn,[e("p",In,[t[103]||(t[103]=$(" Generuj link do resetowania hasła dla użytkownika: ",-1)),e("strong",null,o(pe.value?.name),1)]),e("div",null,[t[105]||(t[105]=e("label",{class:"block text-sm font-medium mb-2"},"Czas ważności linku",-1)),m(e("select",{"onUpdate:modelValue":t[39]||(t[39]=a=>G.value=a),class:"input"},[...t[104]||(t[104]=[e("option",{value:15},"15 minut",-1),e("option",{value:60},"1 godzina",-1),e("option",{value:360},"6 godzin",-1),e("option",{value:1440},"24 godziny",-1)])],512),[[S,G.value]])]),se.value?(l(),n("div",Mn,o(se.value),1)):c("",!0),e("div",Vn,[e("button",{onClick:Kt,disabled:Le.value,class:"btn btn-primary flex-1"},o(Le.value?"Generowanie...":"Generuj link"),9,On),e("button",{type:"button",onClick:Ye,class:"btn btn-outline"}," Anuluj ")])]))])])):c("",!0),Ee.value?(l(),n("div",{key:5,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",onClick:x(Qe,["self"])},[e("div",Wn,[e("div",Kn,[e("h2",Hn,o(ae.value?"Edytuj grupę":"Nowa grupa"),1),e("button",{onClick:Qe,class:"text-gray-400 hover:text-white"},[p(d(O),{class:"w-6 h-6"})])]),e("form",{onSubmit:x(Yt,["prevent"]),class:"space-y-4"},[e("div",null,[t[109]||(t[109]=e("label",{class:"block text-sm font-medium mb-2"},"Nazwa",-1)),m(e("input",{"onUpdate:modelValue":t[40]||(t[40]=a=>P.value.name=a),required:"",class:"input"},null,512),[[k,P.value.name]])]),e("div",null,[t[110]||(t[110]=e("label",{class:"block text-sm font-medium mb-2"},"Waga (domyślnie 1.0)",-1)),m(e("input",{"onUpdate:modelValue":t[41]||(t[41]=a=>P.value.weight=a),type:"number",step:"0.01",required:"",class:"input"},null,512),[[k,P.value.weight,void 0,{number:!0}]])]),ye.value?(l(),n("div",Jn,o(ye.value),1)):c("",!0),e("div",Yn,[e("button",{type:"submit",disabled:Ve.value,class:"btn btn-primary flex-1"},o(Ve.value?"Zapisywanie...":"Zapisz"),9,Qn),e("button",{type:"button",onClick:Qe,class:"btn btn-outline"}," Anuluj ")])],32)])])):c("",!0),ee.value?(l(),n("div",{key:6,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",onClick:t[47]||(t[47]=x(a=>ee.value=!1,["self"]))},[e("div",Xn,[e("div",ei,[t[111]||(t[111]=e("h2",{class:"text-2xl font-bold"},"Edytuj użytkownika",-1)),e("button",{onClick:t[42]||(t[42]=a=>ee.value=!1),class:"text-gray-400 hover:text-white"},[p(d(O),{class:"w-6 h-6"})])]),e("form",{onSubmit:x(Ot,["prevent"]),class:"space-y-4"},[e("div",null,[t[112]||(t[112]=e("label",{class:"block text-sm font-medium mb-2"},"Nazwa",-1)),m(e("input",{"onUpdate:modelValue":t[43]||(t[43]=a=>j.value.name=a),required:"",class:"input"},null,512),[[k,j.value.name]])]),e("div",null,[t[113]||(t[113]=e("label",{class:"block text-sm font-medium mb-2"},"Email",-1)),m(e("input",{"onUpdate:modelValue":t[44]||(t[44]=a=>j.value.email=a),type:"email",required:"",class:"input"},null,512),[[k,j.value.email]])]),e("div",null,[t[114]||(t[114]=e("label",{class:"block text-sm font-medium mb-2"},"Rola",-1)),m(e("select",{"onUpdate:modelValue":t[45]||(t[45]=a=>j.value.role=a),required:"",class:"input"},[(l(!0),n(f,null,g(ke.value,a=>(l(),n("option",{key:a.id,value:a.name},o(a.displayName),9,ti))),128))],512),[[S,j.value.role]])]),M.value?(l(),n("div",si,o(M.value),1)):c("",!0),e("div",ai,[e("button",{type:"submit",disabled:Me.value,class:"btn btn-primary flex-1"},o(Me.value?"Zapisywanie...":"Zapisz"),9,oi),e("button",{type:"button",onClick:t[46]||(t[46]=a=>ee.value=!1),class:"btn btn-outline"}," Anuluj ")])],32)])])):c("",!0),Re.value?(l(),n("div",{key:7,class:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",onClick:t[50]||(t[50]=x(a=>Re.value=!1,["self"]))},[e("div",li,[e("div",ni,[e("h2",ii,"Użytkownicy w grupie: "+o(I.value?.name),1),e("button",{onClick:t[48]||(t[48]=a=>Re.value=!1),class:"text-gray-400 hover:text-white"},[p(d(O),{class:"w-6 h-6"})])]),e("div",ri,[e("div",null,[t[116]||(t[116]=e("label",{class:"block text-sm font-medium mb-2"},"Dodaj użytkownika do grupy",-1)),m(e("select",{"onUpdate:modelValue":t[49]||(t[49]=a=>W.value=a),class:"input mb-2"},[t[115]||(t[115]=e("option",{value:""},"Wybierz użytkownika",-1)),(l(!0),n(f,null,g(es(),a=>(l(),n("option",{key:a.id,value:a.id},o(a.name)+" ("+o(a.email)+") ",9,ui))),128))],512),[[S,W.value]]),e("button",{onClick:ts,disabled:!W.value||Fe.value,class:"btn btn-primary btn-sm"},o(Fe.value?"Dodawanie...":"Dodaj do grupy"),9,di)]),Xe(I.value?.id).length>0?(l(),n("div",ci,[t[117]||(t[117]=e("label",{class:"block text-sm font-medium mb-2"},"Obecni członkowie",-1)),e("div",pi,[(l(!0),n(f,null,g(Xe(I.value?.id),a=>(l(),n("div",{key:a.id,class:"flex justify-between items-center p-3 bg-gray-700/30 rounded-lg"},[e("div",null,[e("p",mi,o(a.name),1),e("p",yi,o(a.email),1)]),e("button",{onClick:u=>ss(a.id),class:"btn btn-sm btn-secondary"},[p(d(de),{class:"w-3 h-3"})],8,vi)]))),128))])])):(l(),n("div",wi," Brak użytkowników w tej grupie ")),K.value?(l(),n("div",bi,o(K.value),1)):c("",!0)])])])):c("",!0),re.value||D.value?(l(),n("div",{key:8,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:t[57]||(t[57]=x(a=>{re.value=!1,D.value=!1},["self"]))},[e("div",ki,[e("div",fi,[e("h3",gi,o(D.value?"Edytuj rolę":"Nowa rola"),1),e("button",{onClick:t[51]||(t[51]=a=>{re.value=!1,D.value=!1}),class:"text-gray-400 hover:text-white"},[p(d(O),{class:"w-5 h-5"})])]),e("form",{onSubmit:t[56]||(t[56]=x(a=>D.value?js():_s(),["prevent"])),class:"space-y-4"},[e("div",null,[t[118]||(t[118]=e("label",{class:"block text-sm font-medium mb-2"},"Nazwa systemowa",-1)),m(e("input",{"onUpdate:modelValue":t[52]||(t[52]=a=>_.value.name=a),type:"text",class:"input",disabled:D.value,required:""},null,8,xi),[[k,_.value.name]])]),e("div",null,[t[119]||(t[119]=e("label",{class:"block text-sm font-medium mb-2"},"Nazwa wyświetlana",-1)),m(e("input",{"onUpdate:modelValue":t[53]||(t[53]=a=>_.value.displayName=a),type:"text",class:"input",required:""},null,512),[[k,_.value.displayName]])]),e("div",null,[t[120]||(t[120]=e("label",{class:"block text-sm font-medium mb-3"},"Uprawnienia",-1)),e("div",hi,[(l(!0),n(f,null,g(xt.value,(a,u)=>(l(),n("div",{key:u,class:"p-3 bg-gray-700/30 rounded-lg"},[e("h4",zi,o(ms(u)),1),e("div",_i,[(l(!0),n(f,null,g(a,b=>(l(),n("label",{key:b.name,class:"flex items-center gap-2 cursor-pointer"},[m(e("input",{type:"checkbox",value:b.name,"onUpdate:modelValue":t[54]||(t[54]=C=>_.value.permissions=C),class:"checkbox"},null,8,ji),[[_t,_.value.permissions]]),e("span",Ui,o(ys(b.description)),1)]))),128))])]))),128))])]),e("div",Ni,[e("button",Ci,o(D.value?"Zapisz":"Utwórz"),1),e("button",{type:"button",onClick:t[55]||(t[55]=a=>{re.value=!1,D.value=!1}),class:"btn btn-outline"}," Anuluj ")])],32)])])):c("",!0)])}}};export{Li as default};
