import{c as I,_ as U,i as K,j as O,r as i,l as C,o as Z,z as G,A as S,b as r,e as t,f as d,u,t as s,p as H,g as f,q as L,v as k,y as M,F as J,h as Q,n as V,s as W,m as X,d as o}from"./index-64eViR4o-1765275765937.js";import{K as j}from"./key-BV4Pw5Hy-1765275765937.js";import{C as B}from"./circle-alert-uQjA8Mrg-1765275765937.js";import{L as D}from"./lock-BaD7Jyxx-1765275765937.js";import{C as Y}from"./circle-check-big-DjjoV9Jl-1765275765937.js";/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=I("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),te={class:"min-h-screen flex items-center justify-center px-4"},se={class:"card max-w-md w-full"},ae={class:"text-center mb-8"},oe={class:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-purple-600 to-pink-600 mb-4"},re={class:"text-4xl font-bold gradient-text mb-2"},ne={class:"text-gray-400"},le={key:0,class:"text-center py-8"},ie={class:"text-gray-400"},ue={key:1,class:"space-y-4"},de={class:"flex items-center gap-2 p-4 rounded-xl bg-red-500/10 border border-red-500/30 text-red-400"},ce={class:"font-medium"},pe={class:"text-sm mt-1"},he={class:"block text-sm font-medium mb-2 text-gray-300"},fe={class:"text-xs text-gray-400 mt-1"},ve={class:"block text-sm font-medium mb-2 text-gray-300"},me={key:0,class:"space-y-1"},we={class:"flex gap-1"},ge={key:1,class:"flex items-center gap-2 p-4 rounded-xl bg-red-500/10 border border-red-500/30 text-red-400"},be={key:2,class:"space-y-3"},ye={class:"flex items-center gap-2 p-4 rounded-xl bg-green-500/10 border border-green-500/30 text-green-400"},ke={class:"flex-1"},_e={class:"font-medium"},xe={class:"text-sm mt-1"},Te=["disabled"],Pe={key:0,class:"loading-spinner"},$e={__name:"ResetPassword",setup(Ce){const{t:l}=K(),x=X(),z=G(),T=O(),v=i(""),n=i(""),m=i(""),h=i(!1),w=i(!0),c=i(""),g=i(""),b=i(!1),_=i(!1),P=C(()=>m.value?n.value===m.value:!0),y=C(()=>{const e=n.value;if(!e)return 0;let a=0;return e.length>=8&&a++,e.length>=12&&a++,/[a-z]/.test(e)&&/[A-Z]/.test(e)&&a++,/\d/.test(e)&&a++,/[^a-zA-Z\d]/.test(e)&&a++,Math.min(a,4)});function A(e){return e<=1?"bg-red-500":e===2?"bg-yellow-500":e===3?"bg-blue-500":"bg-green-500"}function N(e){return e<=1?"text-red-400":e===2?"text-yellow-400":e===3?"text-blue-400":"text-green-400"}function R(e){return e<=1?l("auth.weakPassword"):l(e===2?"auth.mediumPassword":e===3?"auth.goodPassword":"auth.strongPassword")}Z(async()=>{if(v.value=z.query.token,!v.value){g.value=l("errors.noTokenInUrl"),w.value=!1;return}try{await S.get(`/auth/validate-reset-token?token=${v.value}`),w.value=!1}catch(e){console.error("Token validation failed:",e),g.value=e.response?.data?.error||l("errors.invalidOrExpiredToken"),w.value=!1}});async function q(){if(!P.value){c.value=l("errors.passwordsMismatch");return}if(n.value.length<8){c.value=l("errors.passwordTooShort");return}h.value=!0,c.value="";try{const e=await S.post("/auth/reset-password",{token:v.value,newPassword:n.value});T.setTokens(e.data.accessToken,e.data.refreshToken),await T.loadUser(),b.value=!0}catch(e){console.error("Password reset failed:",e),c.value=e.response?.data?.error||l("errors.resetPasswordFailed")}finally{h.value=!1}}function E(){n.value&&navigator.clipboard.writeText(n.value).then(()=>{_.value=!0,setTimeout(()=>{_.value=!1},2e3)}).catch(e=>{console.error("Failed to copy password:",e)})}function F(){x.push("/")}function $(){x.push("/login")}return(e,a)=>(o(),r("div",te,[t("div",se,[t("div",ae,[t("div",oe,[d(u(j),{class:"w-8 h-8 text-white"})]),t("h1",re,s(e.$t("auth.resetPasswordTitle")),1),t("p",ne,s(e.$t("auth.resetPasswordDescription")),1)]),w.value?(o(),r("div",le,[a[2]||(a[2]=t("div",{class:"loading-spinner mx-auto mb-4"},null,-1)),t("p",ie,s(e.$t("auth.validatingToken")),1)])):g.value?(o(),r("div",ue,[t("div",de,[d(u(B),{class:"w-5 h-5"}),t("div",null,[t("p",ce,s(e.$t("auth.invalidOrExpiredToken")),1),t("p",pe,s(g.value),1)])]),t("button",{onClick:$,class:"btn btn-outline w-full"},s(e.$t("auth.backToLogin")),1)])):(o(),r("form",{key:2,onSubmit:H(q,["prevent"]),class:"space-y-5"},[t("div",null,[t("label",he,[d(u(D),{class:"w-4 h-4 inline mr-2"}),k(" "+s(e.$t("auth.newPassword")),1)]),L(t("input",{"onUpdate:modelValue":a[0]||(a[0]=p=>n.value=p),type:"password",required:"",minlength:"8",class:"input",placeholder:"••••••••"},null,512),[[M,n.value]]),t("p",fe,s(e.$t("auth.minPasswordLength")),1)]),t("div",null,[t("label",ve,[d(u(D),{class:"w-4 h-4 inline mr-2"}),k(" "+s(e.$t("auth.confirmNewPassword")),1)]),L(t("input",{"onUpdate:modelValue":a[1]||(a[1]=p=>m.value=p),type:"password",required:"",minlength:"8",class:"input",placeholder:"••••••••"},null,512),[[M,m.value]])]),n.value?(o(),r("div",me,[t("div",we,[(o(),r(J,null,Q(4,p=>t("div",{key:p,class:V(["h-1 flex-1 rounded-full transition-colors",y.value>=p?A(y.value):"bg-gray-700"])},null,2)),64))]),t("p",{class:V(["text-xs",N(y.value)])},s(R(y.value)),3)])):f("",!0),c.value?(o(),r("div",ge,[d(u(B),{class:"w-5 h-5"}),t("span",null,s(c.value),1)])):f("",!0),b.value?(o(),r("div",be,[t("div",ye,[d(u(Y),{class:"w-5 h-5"}),t("div",ke,[t("p",_e,s(e.$t("auth.passwordChanged")),1),t("p",xe,s(e.$t("auth.redirectToDashboard")),1)])]),t("button",{type:"button",onClick:E,class:"btn btn-outline w-full flex items-center justify-center gap-2"},[d(u(ee),{class:"w-5 h-5"}),k(" "+s(_.value?e.$t("common.copied"):e.$t("auth.copyPassword")),1)]),t("button",{type:"button",onClick:F,class:"btn btn-primary w-full"},s(e.$t("auth.goToDashboard")),1)])):f("",!0),b.value?f("",!0):(o(),r("button",{key:3,type:"submit",disabled:h.value||!P.value||n.value.length<8,class:"btn btn-primary w-full flex items-center justify-center gap-2"},[h.value?(o(),r("div",Pe)):(o(),W(u(j),{key:1,class:"w-5 h-5"})),k(" "+s(h.value?e.$t("common.resetting"):e.$t("auth.resetButton")),1)],8,Te)),b.value?f("",!0):(o(),r("button",{key:4,type:"button",onClick:$,class:"btn btn-outline w-full"},s(e.$t("common.cancel")),1))],32))])]))}},Be=U($e,[["__scopeId","data-v-6d6a8d70"]]);export{Be as default};
